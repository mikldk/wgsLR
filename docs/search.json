[{"path":"/articles/introduction.html","id":"estimating-the-genotype-error-probability-w","dir":"Articles","previous_headings":"","what":"Estimating the genotype error probability, ww","title":"Introduction","text":"simple example:","code":"cases <- sample_data_Hp_w(n = 1000, w = 0.1, p = c(0.25, 0.25, 0.5)) tab <- table(cases$xT, cases$xR) tab #>     #>       0   1   2 #>   0 180  53   7 #>   1  55 193  99 #>   2   8  78 327"},{"path":"/articles/introduction.html","id":"maximum-likelihood-estimation","dir":"Articles","previous_headings":"Estimating the genotype error probability, ww","what":"Maximum likelihood estimation","title":"Introduction","text":"last lines estimate standard error used construct approximate confidence interval. Please aware “Cautionary note” README (just using standard VCF-files).","code":"w_mle <- wgsLR::estimate_w(tab) w_mle #> [1] 0.0952511 w_mle_se <- wgsLR::estimate_w_se(tab, w_mle) w_mle_se #> [1] 0.005846342"},{"path":"/articles/introduction.html","id":"bayesian-inference","dir":"Articles","previous_headings":"Estimating the genotype error probability, ww","what":"Bayesian inference","title":"Introduction","text":"package contains simple Metropolis-Hastings sampler (also see “Using Stan Bayesian inference” vignette):  dashed lines indicate approximate confidence intervals (maximum likelihood estimation) credible interval (Bayesian inference). Please aware “Cautionary note” README (just using standard VCF-files).","code":"w_b <- wgsLR::estimate_w_bayesian(tab) |> posterior_samples() w_b_q <- quantile(w_b, c(0.025, 0.975)) hist(w_b, main = NULL, xlab = expression(hat(w))) abline(v = mean(w_b), col = \"deeppink3\", lwd = 3) abline(v = w_b_q[1], col = \"deeppink3\", lty = 2) abline(v = w_b_q[2], col = \"deeppink3\", lty = 2) abline(v = w_mle, col = \"yellow3\", lwd = 3) abline(v = w_mle - 2*w_mle_se, col = \"yellow3\", lty = 2) abline(v = w_mle + 2*w_mle_se, col = \"yellow3\", lty = 2) legend(\"topright\", col = c(\"deeppink3\", \"yellow3\"), legend = c(\"Bayesian\", \"MLE\"), lty = 1, lwd = 2)"},{"path":"/articles/introduction.html","id":"calculating-likelihood-ratios-lrs","dir":"Articles","previous_headings":"","what":"Calculating likelihood ratios (LRLR’s)","title":"Introduction","text":"errors matching genotypes: errors non-matching genotypes: Errors possible matching genotypes: Errors possible non-matching genotypes:","code":"LR_contribs <- wgsLR::calc_LRs_w(xT = c(0, 0),                                   xR = c(0, 0),                                   w = 0,                                   p = c(0.25, 0.25, 0.5)) prod(LR_contribs) #> [1] 16 LR_contribs <- wgsLR::calc_LRs_w(xT = c(1, 0),                                   xR = c(0, 0),                                   w = 0,                                   p = c(0.25, 0.25, 0.5)) prod(LR_contribs) #> [1] 0 LR_contribs <- wgsLR::calc_LRs_w(xT = c(0, 0),                                   xR = c(0, 0),                                   w = 0.001,                                   p = c(0.25, 0.25, 0.5)) prod(LR_contribs) #> [1] 15.936 LR_contribs <- wgsLR::calc_LRs_w(xT = c(1, 0),                                   xR = c(0, 0),                                   w = 0.001,                                   p = c(0.25, 0.25, 0.5)) prod(LR_contribs) #> [1] 0.04761785"},{"path":"/articles/introduction.html","id":"different-error-rates","dir":"Articles","previous_headings":"Calculating likelihood ratios (LRLR’s)","what":"Different error rates","title":"Introduction","text":"Assume trace donor profile wt=10−4w_t = 10^{-4} suspect reference profile wr=10−8w_r = 10^{-8}. LRLR :","code":"LR_contribs <- wgsLR::calc_LRs_wTwR(xT = c(1, 0),                                      xR = c(0, 0),                                      wT = 1e-4,                                      wR = 1e-8,                                     p = c(0.25, 0.25, 0.5)) prod(LR_contribs) #> [1] 0.003198241"},{"path":"/articles/introduction.html","id":"verifying-formulas","dir":"Articles","previous_headings":"","what":"Verifying formulas","title":"Introduction","text":"usual LRLR values, 1pZS\\frac{1}{p_{Z^S}} matches 00 non-matches, obtained setting w=0w = 0. example packages wgsLR caracas loaded can following: sample specific error rates, wDw_D wSw_S:","code":"library(caracas) LR <- d_LR_w$expr LRw0 <- sapply(LR, \\(x) as_sym(x) |> subs(\"w\", 0) |> as_character()) with(d_LR_w, cbind(xT, xR, LRw0)) #>       xT  xR  LRw0    #>  [1,] \"0\" \"0\" \"1/p_0\" #>  [2,] \"0\" \"1\" \"0\"     #>  [3,] \"0\" \"2\" \"0\"     #>  [4,] \"1\" \"0\" \"0\"     #>  [5,] \"1\" \"1\" \"1/p_1\" #>  [6,] \"1\" \"2\" \"0\"     #>  [7,] \"2\" \"0\" \"0\"     #>  [8,] \"2\" \"1\" \"0\"     #>  [9,] \"2\" \"2\" \"1/p_2\" library(caracas) LR <- d_LR_wTwR$expr LRw0 <- sapply(LR, \\(x) as_sym(x) |>                   subs(\"wT\", 0) |>                   subs(\"wR\", 0) |> as_character()) with(d_LR_wTwR, cbind(xT, xR, LRw0)) #>       xT  xR  LRw0    #>  [1,] \"0\" \"0\" \"1/p_0\" #>  [2,] \"0\" \"1\" \"0\"     #>  [3,] \"0\" \"2\" \"0\"     #>  [4,] \"1\" \"0\" \"0\"     #>  [5,] \"1\" \"1\" \"1/p_1\" #>  [6,] \"1\" \"2\" \"0\"     #>  [7,] \"2\" \"0\" \"0\"     #>  [8,] \"2\" \"1\" \"0\"     #>  [9,] \"2\" \"2\" \"1/p_2\""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Mikkel Meyer Andersen. Author, maintainer, copyright holder. Poul Svante Eriksen. Author, copyright holder.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Andersen M, Kampmann M, Jepsen , Morling N, Eriksen P, Børsting C, Andersen J (2025). “Shotgun DNA sequencing human identification: Dynamic SNP selection likelihood ratio calculations accounting errors.” Forensic Science International: Genetics, 74. ISSN 1872-4973, doi:10.1016/j.fsigen.2024.103146, https://doi.org/10.1016/j.fsigen.2024.103146.","code":"@Article{wgsLR,   doi = {10.1016/j.fsigen.2024.103146},   url = {https://doi.org/10.1016/j.fsigen.2024.103146},   author = {Mikkel Meyer Andersen and Marie-Louise Kampmann and Alberte Honoré Jepsen and Niels Morling and Poul Svante Eriksen and Claus Børsting and Jeppe Dyrberg Andersen},   title = {{Shotgun DNA sequencing for human identification: Dynamic SNP selection and likelihood ratio calculations accounting for errors}},   journal = {Forensic Science International: Genetics},   volume = {74},   issn = {1872-4973},   publisher = {Elsevier BV},   year = {2025}, }"},{"path":"/index.html","id":"wgslr-shotgun-sequencing-for-human-identification-dynamic-snp-marker-sets-and-likelihood-ratio-calculations-accounting-for-errors","dir":"","previous_headings":"","what":"Whole-genome sequencing genotype error estimation and forensic likelihood ratios accounting for errors","title":"Whole-genome sequencing genotype error estimation and forensic likelihood ratios accounting for errors","text":"Please refer online documentation https://mikldk.github.io/wgsLR, including vignettes.","code":""},{"path":"/index.html","id":"scientific-publication","dir":"","previous_headings":"","what":"Scientific publication","title":"Whole-genome sequencing genotype error estimation and forensic likelihood ratios accounting for errors","text":"research associated software described Andersen, M. M., Kampmann, M.-L., Jepsen, . H., Morling, N., Eriksen, P. S., Børsting, C., & Andersen, J. D. (2025). Shotgun DNA sequencing human identification: Dynamic SNP selection likelihood ratio calculations accounting errors. Forensic Science International: Genetics, 74, 103146. doi:10.1016/j.fsigen.2024.103146.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Whole-genome sequencing genotype error estimation and forensic likelihood ratios accounting for errors","text":"install Github vignettes run command within R (please install remotes first already installed): can also install package without vignettes needed follows:","code":"# install.packages('remotes') remotes::install_github(\"mikldk/wgsLR\", build_vignettes = TRUE) remotes::install_github(\"mikldk/wgsLR\")"},{"path":[]},{"path":"/index.html","id":"estimating-the-genotype-error-probability-w","dir":"","previous_headings":"A few small examples","what":"Estimating the genotype error probability, ww","title":"Whole-genome sequencing genotype error estimation and forensic likelihood ratios accounting for errors","text":"","code":"cases <- wgsLR::sample_data_Hp_w(n = 1000, w = 0.1, p = c(0.25, 0.25, 0.5)) tab <- table(cases$xT, cases$xR) tab ##     ##       0   1   2 ##   0 171  62   4 ##   1  65 193 100 ##   2  12  72 321 w_mle <- wgsLR::estimate_w(tab) w_mle ## [1] 0.1012883"},{"path":"/index.html","id":"cautionary-note-not-just-standard-vcf-files","dir":"","previous_headings":"A few small examples > Estimating the genotype error probability, ww","what":"Cautionary note: not just standard VCF files","title":"Whole-genome sequencing genotype error estimation and forensic likelihood ratios accounting for errors","text":"necessary obtain sequencing results bases selected segments (including read depth genotype quality). Thus, sufficient just use information “confirmed”/high probability variants reference genome (variants identified standard vcf-file format), can introduce bias results. Information bases chosen genomic areas interest needed. One way achieve using GATK HaplotypeCaller additional argument --emit-ref-confidence BP_RESOLUTION genomic areas interest (using -L areas.interval_list).","code":""},{"path":"/index.html","id":"calculating-likelihood-ratios-lrs","dir":"","previous_headings":"A few small examples","what":"Calculating likelihood ratios (LRLR’s)","title":"Whole-genome sequencing genotype error estimation and forensic likelihood ratios accounting for errors","text":"genotyping error probability trace sample (xt=x_t =xT) reference sample (xr=x_r =xR): Sample-specific genotyping error probabilities wtw_t wrw_r trace sample (xt=x_t =xT) reference sample (xr=x_r =xR), repectively:","code":"tab <- wgsLR::d_LR_w[, c(\"xT\", \"xR\")] tab$LR <- paste0(\"$\", wgsLR::d_LR_w$expr_tex, \"$\") tab |>    kbl(format = \"markdown\") tab <- wgsLR::d_LR_wTwR[, c(\"xT\", \"xR\")] tab$LR <- paste0(\"$\", wgsLR::d_LR_wTwR$expr_tex, \"$\") tab |>    kbl(format = \"markdown\")"},{"path":"/index.html","id":"example","dir":"","previous_headings":"A few small examples > Calculating likelihood ratios (LRLR’s)","what":"Example","title":"Whole-genome sequencing genotype error estimation and forensic likelihood ratios accounting for errors","text":"Assume trace sample four loci genotypes (0/1 = 1, 0/0 = 0, 1/1 = 2, 1/1 = 2). person interest typed four loci genotypes (0/0 = 0, 0/0 = 0, 1/1 = 2, 1/1 = 2), .e. mismatch first locus. simplicity, assume genotype probabilites P(0/0 = 0) = 0.25, P(0/1 = 1/0 = 1) = 0.25, P(1/1 = 2) = 0.5. errors possible, w=0w=0 product 0 due mismatch first locus. instead acknowledge errors possible, w=0.001w = 0.001 obtain can also consider LRLRs range plausible values ww:","code":"wgsLR::calc_LRs_w(xT = c(1, 0, 2, 2),                   xR = c(0, 0, 2, 2),                    w = 0,                    p = c(0.25, 0.25, 0.5)) ## [1] 0 4 2 2 LR_contribs <- wgsLR::calc_LRs_w(xT = c(1, 0, 2, 2),                                   xR = c(0, 0, 2, 2),                                   w = 0.001,                                   p = c(0.25, 0.25, 0.5)) LR_contribs ## [1] 0.01192834 3.99199202 1.99799850 1.99799850 prod(LR_contribs) ## [1] 0.1900904 ws <- c(1e-6, 1e-3, 1e-2, 1e-1) LRs <- sapply(ws, \\(w) wgsLR::calc_LRs_w(xT = c(0, 0, 2, 2),                                           xR = c(1, 0, 2, 2),                                           w = w,                                           p = c(0.25, 0.25, 0.5)) |>                  prod()) data.frame(log10w = log10(ws), w = ws,             LR = LRs, WoElog10LR = log10(LRs)) ##   log10w     w           LR WoElog10LR ## 1     -6 1e-06 0.0001919981 -3.7167031 ## 2     -3 1e-03 0.1900903523 -0.7210399 ## 3     -2 1e-02 1.7379421372  0.2400353 ## 4     -1 1e-01 7.1409934157  0.8537586"},{"path":"/index.html","id":"different-error-rates","dir":"","previous_headings":"","what":"Different error rates","title":"Whole-genome sequencing genotype error estimation and forensic likelihood ratios accounting for errors","text":"Assume trace donor profile wD=10−4w_D = 10^{-4} suspect reference profile wS=10−8w_S = 10^{-8}. LRLR :","code":"LR_contribs <- wgsLR::calc_LRs_wTwR(xT = c(1, 0, 2, 2),                                      xR = c(0, 0, 2, 2),                                      wT = 1e-4,                                      wR = 1e-8,                                     p = c(0.25, 0.25, 0.5)) prod(LR_contribs) ## [1] 0.01279168"},{"path":"/reference/add_errors_Hd.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Hp-errors to table — add_errors_Hd","title":"Add Hp-errors to table — add_errors_Hd","text":"Add Hp-errors table","code":""},{"path":"/reference/add_errors_Hd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Hp-errors to table — add_errors_Hd","text":"","code":"add_errors_Hd(tab, w)"},{"path":"/reference/add_errors_Hd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Hp-errors to table — add_errors_Hd","text":"tab table add errors w error probability","code":""},{"path":"/reference/add_errors_Hd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add Hp-errors to table — add_errors_Hd","text":"","code":"Z_D <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) Z_S <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) tab <- table(to012(Z_D), to012(Z_S)) tab #>     #>       0   1   2 #>   0 141  57 191 #>   1  45  17  66 #>   2 167  58 258 new_tab <- add_errors_Hd(tab, w = 0.15) new_tab #>      [,1] [,2] [,3] #> [1,]   87  111  124 #> [2,]   92   92  128 #> [3,]  112  104  150 estimate_w(new_tab) # wrong! #> [1] 0.5 Z <- sample_profiles_without_error(n = 10000, p = c(0.25, 0.25, 0.5)) tab <- table(to012(Z), to012(Z)) tab #>     #>        0    1    2 #>   0 3756    0    0 #>   1    0 1277    0 #>   2    0    0 4967 new_tab <- add_errors_Hd(tab, w = 0.25) new_tab #>      [,1] [,2] [,3] #> [1,] 1255 1062  356 #> [2,] 1066 1671 1276 #> [3,]  343 1283 1688 estimate_w(new_tab) # ok #> [1] 0.2492552"},{"path":"/reference/add_errors_Hd_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Hd-errors to table for one error probability, $w$ — add_errors_Hd_w","title":"Add Hd-errors to table for one error probability, $w$ — add_errors_Hd_w","text":"Add Hd-errors table one error probability, $w$","code":""},{"path":"/reference/add_errors_Hd_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Hd-errors to table for one error probability, $w$ — add_errors_Hd_w","text":"","code":"add_errors_Hd_w(tab, w)"},{"path":"/reference/add_errors_Hd_w.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Hd-errors to table for one error probability, $w$ — add_errors_Hd_w","text":"tab table add errors w error probability","code":""},{"path":"/reference/add_errors_Hd_w.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add Hd-errors to table for one error probability, $w$ — add_errors_Hd_w","text":"","code":"zT <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) zR <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) tab <- table(to012(zT), to012(zR)) tab #>     #>       0   1   2 #>   0  64  62 135 #>   1  63  71 122 #>   2 109 116 258 new_tab <- add_errors_Hd_w(tab, w = 0.15) #> Error in split.default(x = seq_len(nrow(x)), f = f, drop = drop, ...): group length is 0 but data length > 0 new_tab #> Error: object 'new_tab' not found estimate_w(new_tab) # wrong! #> Error: object 'new_tab' not found Z <- sample_profiles_without_error(n = 10000, p = c(0.25, 0.25, 0.5)) tab <- table(to012(Z), to012(Z)) tab #>     #>        0    1    2 #>   0 2523    0    0 #>   1    0 2513    0 #>   2    0    0 4964 new_tab <- add_errors_Hp_w(tab, w = 0.25) #> Error in add_errors_Hp_w(tab, w = 0.25): isTRUE(all.equal(sum(tab), sum(new_tab))) is not TRUE new_tab #> Error: object 'new_tab' not found estimate_w(new_tab) # ok #> Error: object 'new_tab' not found"},{"path":"/reference/add_errors_Hd_wDwS.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Hd-errors to table for sample-dependent error probabilities, $w_D$ and $w_S$ — add_errors_Hd_wDwS","title":"Add Hd-errors to table for sample-dependent error probabilities, $w_D$ and $w_S$ — add_errors_Hd_wDwS","text":"Add Hd-errors table sample-dependent error probabilities, $w_D$ $w_S$","code":""},{"path":"/reference/add_errors_Hd_wDwS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Hd-errors to table for sample-dependent error probabilities, $w_D$ and $w_S$ — add_errors_Hd_wDwS","text":"","code":"add_errors_Hd_wDwS(tab, wD, wS)"},{"path":"/reference/add_errors_Hd_wDwS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Hd-errors to table for sample-dependent error probabilities, $w_D$ and $w_S$ — add_errors_Hd_wDwS","text":"tab table add errors wD error probability donor sample wS error probability PoI sample","code":""},{"path":"/reference/add_errors_Hd_wDwS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add Hd-errors to table for sample-dependent error probabilities, $w_D$ and $w_S$ — add_errors_Hd_wDwS","text":"","code":"Z_D <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) Z_S <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) tab <- table(to012(Z_D), to012(Z_S)) tab #>     #>       0   1   2 #>   0  80  55 128 #>   1  55  70 122 #>   2 132 118 240 add_errors_Hd_wDwS(tab, wD = 0.1, wS = 1e-6) #>      [,1] [,2] [,3] #> [1,]   73   55  112 #> [2,]   84   85  160 #> [3,]  110  103  218 add_errors_Hd_w(tab, w = 0.05) #>      [,1] [,2] [,3] #> [1,]   70   74  109 #> [2,]   58   95  130 #> [3,]  112  139  213"},{"path":"/reference/add_errors_Hd_wTwR.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Hd-errors to table for sample-dependent error probabilities, $w_t$ and $w_r$ — add_errors_Hd_wTwR","title":"Add Hd-errors to table for sample-dependent error probabilities, $w_t$ and $w_r$ — add_errors_Hd_wTwR","text":"Add Hd-errors table sample-dependent error probabilities, $w_t$ $w_r$","code":""},{"path":"/reference/add_errors_Hd_wTwR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Hd-errors to table for sample-dependent error probabilities, $w_t$ and $w_r$ — add_errors_Hd_wTwR","text":"","code":"add_errors_Hd_wTwR(tab, wT, wR)"},{"path":"/reference/add_errors_Hd_wTwR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Hd-errors to table for sample-dependent error probabilities, $w_t$ and $w_r$ — add_errors_Hd_wTwR","text":"tab table add errors wT error probability donor sample wR error probability PoI sample","code":""},{"path":"/reference/add_errors_Hd_wTwR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add Hd-errors to table for sample-dependent error probabilities, $w_t$ and $w_r$ — add_errors_Hd_wTwR","text":"","code":"zT <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) zR <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) tab <- table(to012(Z_T), to012(zR)) #> Error: object 'Z_T' not found tab #> Error: object 'tab' not found add_errors_Hd_wTwR(tab, wT = 0.1, wR = 1e-6) #> Error: object 'tab' not found add_errors_Hd_w(tab, w = 0.05) #> Error: object 'tab' not found"},{"path":"/reference/add_errors_Hp.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Hp-errors to table — add_errors_Hp","title":"Add Hp-errors to table — add_errors_Hp","text":"Add Hp-errors table","code":""},{"path":"/reference/add_errors_Hp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Hp-errors to table — add_errors_Hp","text":"","code":"add_errors_Hp(tab, w)"},{"path":"/reference/add_errors_Hp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Hp-errors to table — add_errors_Hp","text":"tab table add errors w error probability","code":""},{"path":"/reference/add_errors_Hp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add Hp-errors to table — add_errors_Hp","text":"","code":"Z <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) tab <- table(to012(Z)) tab #>  #>   0   1   2  #> 372 130 498  new_tab <- add_errors_Hp(tab, w = 0.15) new_tab #>      [,1] [,2] [,3] #> [1,]  209   82   15 #> [2,]   79  126  106 #> [3,]   23  116  244 estimate_w(new_tab) #> [1] 0.157036"},{"path":"/reference/add_errors_Hp_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Hp-errors to table for one error probability, $w$ — add_errors_Hp_w","title":"Add Hp-errors to table for one error probability, $w$ — add_errors_Hp_w","text":"Add Hp-errors table one error probability, $w$","code":""},{"path":"/reference/add_errors_Hp_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Hp-errors to table for one error probability, $w$ — add_errors_Hp_w","text":"","code":"add_errors_Hp_w(tab, w)"},{"path":"/reference/add_errors_Hp_w.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Hp-errors to table for one error probability, $w$ — add_errors_Hp_w","text":"tab table add errors w error probability","code":""},{"path":"/reference/add_errors_Hp_w.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add Hp-errors to table for one error probability, $w$ — add_errors_Hp_w","text":"","code":"Z <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) tab <- table(to012(Z)) tab #>  #>   0   1   2  #> 247 230 523  new_tab <- add_errors_Hp_w(tab, w = 0.15) #> Error in add_errors_Hp_w(tab, w = 0.15): isTRUE(all.equal(sum(tab), sum(new_tab))) is not TRUE new_tab #> Error: object 'new_tab' not found estimate_w(new_tab) #> Error: object 'new_tab' not found"},{"path":"/reference/add_errors_Hp_wDwS.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Hp-errors to table for sample-dependent error probabilities, $w_D$ and $w_S$ — add_errors_Hp_wDwS","title":"Add Hp-errors to table for sample-dependent error probabilities, $w_D$ and $w_S$ — add_errors_Hp_wDwS","text":"Add Hp-errors table sample-dependent error probabilities, $w_D$ $w_S$","code":""},{"path":"/reference/add_errors_Hp_wDwS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Hp-errors to table for sample-dependent error probabilities, $w_D$ and $w_S$ — add_errors_Hp_wDwS","text":"","code":"add_errors_Hp_wDwS(tab, wD, wS)"},{"path":"/reference/add_errors_Hp_wDwS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Hp-errors to table for sample-dependent error probabilities, $w_D$ and $w_S$ — add_errors_Hp_wDwS","text":"tab table add errors wD error probability donor sample wS error probability PoI sample","code":""},{"path":"/reference/add_errors_Hp_wDwS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add Hp-errors to table for sample-dependent error probabilities, $w_D$ and $w_S$ — add_errors_Hp_wDwS","text":"","code":"Z <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) tab <- table(to012(Z)) tab #>  #>   0   1   2  #> 254 230 516  add_errors_Hp_wDwS(tab, wD = 0.1, wS = 1e-6) #>      [,1] [,2] [,3] #> [1,]  201   15    4 #> [2,]   52  191   96 #> [3,]    1   24  416 add_errors_Hp_w(tab, w = 0.05) #>      [,1] [,2] [,3] #> [1,]  201   39    2 #> [2,]   37  189   47 #> [3,]    3   63  419"},{"path":"/reference/add_errors_Hp_wTwR.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Hp-errors to table for sample-dependent error probabilities, $w_t$ and $w_r$ — add_errors_Hp_wTwR","title":"Add Hp-errors to table for sample-dependent error probabilities, $w_t$ and $w_r$ — add_errors_Hp_wTwR","text":"Add Hp-errors table sample-dependent error probabilities, $w_t$ $w_r$","code":""},{"path":"/reference/add_errors_Hp_wTwR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Hp-errors to table for sample-dependent error probabilities, $w_t$ and $w_r$ — add_errors_Hp_wTwR","text":"","code":"add_errors_Hp_wTwR(tab, wT, wR)"},{"path":"/reference/add_errors_Hp_wTwR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Hp-errors to table for sample-dependent error probabilities, $w_t$ and $w_r$ — add_errors_Hp_wTwR","text":"tab table add errors wT error probability donor sample wR error probability PoI sample","code":""},{"path":"/reference/add_errors_Hp_wTwR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add Hp-errors to table for sample-dependent error probabilities, $w_t$ and $w_r$ — add_errors_Hp_wTwR","text":"","code":"Z <- sample_profiles_without_error(n = 1000, p = c(0.25, 0.25, 0.5)) tab <- table(to012(Z)) tab #>  #>   0   1   2  #> 255 226 519  add_errors_Hp_wTwR(tab, wT = 0.1, wR = 1e-6) #> Error in add_errors_Hp_wTwR(tab, wT = 0.1, wR = 1e-06): isTRUE(all.equal(sum(tab), sum(new_tab))) is not TRUE add_errors_Hp_w(tab, w = 0.05) #> Error in add_errors_Hp_w(tab, w = 0.05): isTRUE(all.equal(sum(tab), sum(new_tab))) is not TRUE"},{"path":"/reference/add_errors_to_genotypes.html","id":null,"dir":"Reference","previous_headings":"","what":"Add errors to genotypes — add_errors_to_genotypes","title":"Add errors to genotypes — add_errors_to_genotypes","text":"Add errors genotypes","code":""},{"path":"/reference/add_errors_to_genotypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add errors to genotypes — add_errors_to_genotypes","text":"","code":"add_errors_to_genotypes(Z, w, overdisp_var = NULL)"},{"path":"/reference/add_errors_to_genotypes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add errors to genotypes — add_errors_to_genotypes","text":"Z genotypes, e.g. created sample_profiles_without_error() w error probability overdisp_var set, use modelling overdispersion $w$ $w$ follows Beta distribution mean value $w$ variance overdisp_var","code":""},{"path":"/reference/add_errors_to_genotypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add errors to genotypes — add_errors_to_genotypes","text":"list, element locus matrix n rows two columns","code":""},{"path":"/reference/add_errors_to_genotypes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add errors to genotypes — add_errors_to_genotypes","text":"","code":"Z <- sample_profiles_without_error(n = 5, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) to012(Z) #>      [,1] [,2] #> [1,]    0    0 #> [2,]    2    1 #> [3,]    0    1 #> [4,]    2    2 #> [5,]    0    1 X <- add_errors_to_genotypes(Z, 0.5) X #> [[1]] #>      [,1] [,2] #> [1,]    1    1 #> [2,]    0    0 #> [3,]    0    1 #> [4,]    1    1 #> [5,]    0    0 #>  #> [[2]] #>      [,1] [,2] #> [1,]    0    1 #> [2,]    0    0 #> [3,]    1    0 #> [4,]    1    0 #> [5,]    0    0 #>  to012(Z) - to012(add_errors_to_genotypes(Z, 0.0)) #>      [,1] [,2] #> [1,]    0    0 #> [2,]    0    0 #> [3,]    0    0 #> [4,]    0    0 #> [5,]    0    0   Z <- sample_profiles_without_error(n = 1000, p = c(0.5, 0.4, 0.1)) X1 <- add_errors_to_genotypes(Z, 0.1) X2 <- add_errors_to_genotypes(Z, 0.1) tab <- table(to012(X1), to012(X2)) tab #>     #>       0   1   2 #>   0 325  95   4 #>   1 133 266  46 #>   2   5  47  79 estimate_w(tab) #> [1] 0.1042099  X1 <- add_errors_to_genotypes(Z, 0.1, overdisp_var = 0.01) X2 <- add_errors_to_genotypes(Z, 0.1, overdisp_var = 0.01) tab <- table(to012(X1), to012(X2)) tab #>     #>       0   1   2 #>   0 331 100  14 #>   1  99 288  47 #>   2  10  37  74 estimate_w(tab) #> [1] 0.1014438 # p <- get_beta_parameters(0.1, 0.01); curve(dbeta(x, p[1], p[2]), from = 0, to = 1)   # p <- get_beta_parameters(0.1, 0.01); curve(dbeta(x, p[1], p[2]), from = 0, to = 1) X1 <- add_errors_to_genotypes(Z, 0.1, overdisp_var = 0.01) X2 <- add_errors_to_genotypes(Z, 0.1, overdisp_var = 0.01) tab <- table(to012(X1), to012(X2)) tab #>     #>       0   1   2 #>   0 355  89  19 #>   1  93 294  34 #>   2   9  39  68 estimate_w(tab) #> [1] 0.09397646"},{"path":"/reference/allele_probs_to_geno_probs.html","id":null,"dir":"Reference","previous_headings":"","what":"Allele probabilities to genotype probabilities assuming Hardy-Weinberg equilibrium — allele_probs_to_geno_probs","title":"Allele probabilities to genotype probabilities assuming Hardy-Weinberg equilibrium — allele_probs_to_geno_probs","text":"Allele probabilities genotype probabilities assuming Hardy-Weinberg equilibrium","code":""},{"path":"/reference/allele_probs_to_geno_probs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Allele probabilities to genotype probabilities assuming Hardy-Weinberg equilibrium — allele_probs_to_geno_probs","text":"","code":"allele_probs_to_geno_probs(x)"},{"path":"/reference/allele_probs_to_geno_probs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Allele probabilities to genotype probabilities assuming Hardy-Weinberg equilibrium — allele_probs_to_geno_probs","text":"","code":"allele_probs_to_geno_probs(c(0.1, 0.2)) #> [[1]] #> [1] 0.01 0.18 0.81 #>  #> [[2]] #> [1] 0.04 0.32 0.64 #>"},{"path":"/reference/beta05.html","id":null,"dir":"Reference","previous_headings":"","what":"Beta distribution on (0, 0.5) — rbeta05","title":"Beta distribution on (0, 0.5) — rbeta05","text":"Beta distribution (0, 0.5)","code":""},{"path":"/reference/beta05.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Beta distribution on (0, 0.5) — rbeta05","text":"","code":"rbeta05(n, shape1, shape2)  pbeta05(x, shape1, shape2)  qbeta05(x, shape1, shape2)  dbeta05(x, shape1, shape2, log = FALSE)"},{"path":"/reference/beta05.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Beta distribution on (0, 0.5) — rbeta05","text":"n number random samples draw shape1 first shape parameter shape2 second shape parameter x number 0 0.5 log return result log scale","code":""},{"path":"/reference/beta05.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Beta distribution on (0, 0.5) — rbeta05","text":"","code":"dbeta05(0.2, 1, 5) #> [1] 1.296 dbeta05(0.2, 1, 5, log = TRUE) #> [1] 0.2592826 dbeta05(0.2, 1, 5) |> log() #> [1] 0.2592826  pbeta05(0.5, 1, 5) #> [1] 1  qbeta05(1, 1, 5) #> [1] 0.5  #rbeta05(100, 1, 5) |> hist(probability = TRUE) #curve(dbeta05(x, 1, 5), from = 0, to = 0.5, add = TRUE)"},{"path":"/reference/calc_LRs.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate LR for a profile — calc_LRs","title":"Calculate LR for a profile — calc_LRs","text":"Calculate LR profile","code":""},{"path":"/reference/calc_LRs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate LR for a profile — calc_LRs","text":"","code":"calc_LRs(xs, xd, w, p)"},{"path":"/reference/calc_LRs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate LR for a profile — calc_LRs","text":"xs profile suspect (0, 1, 2) xd profile case (0, 1, 2) w error probability p list genotype probabilities (length xd/xs, vector length 3 reuse)","code":""},{"path":"/reference/calc_LRs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate LR for a profile — calc_LRs","text":"","code":"calc_LRs(c(0, 0), c(0, 0), w = 0, p = c(0.25, 0.25, 0.5)) #> [1] 4 4 calc_LRs(c(0, 0), c(0, 0), w = 0, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> [1]  4 10    calc_LRs(c(0, 0), c(0, 1), w = 0, p = c(0.25, 0.25, 0.5)) #> [1] 4 0 calc_LRs(c(0, 0), c(0, 1), w = 1e-5, p = c(0.25, 0.25, 0.5)) #> [1] 3.9999199992 0.0001199928 calc_LRs(c(0, 0), c(0, 1), w = 1e-3, p = c(0.25, 0.25, 0.5)) #> [1] 3.99199202 0.01192834"},{"path":"/reference/calc_LRs_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate LR for a profile for one error probability, $w$ — calc_LRs_w","title":"Calculate LR for a profile for one error probability, $w$ — calc_LRs_w","text":"Calculate LR profile one error probability, $w$","code":""},{"path":"/reference/calc_LRs_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate LR for a profile for one error probability, $w$ — calc_LRs_w","text":"","code":"calc_LRs_w(xT, xR, w, p)"},{"path":"/reference/calc_LRs_w.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate LR for a profile for one error probability, $w$ — calc_LRs_w","text":"xT profile case (0, 1, 2) xR profile suspect (0, 1, 2) w error probability p list genotype probabilities (length xT/xR, vector length 3 reuse)","code":""},{"path":"/reference/calc_LRs_w.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate LR for a profile for one error probability, $w$ — calc_LRs_w","text":"","code":"calc_LRs_w(c(0, 0), c(0, 0), w = 0, p = c(0.25, 0.25, 0.5)) #> [1] 4 4 calc_LRs_w(c(0, 0), c(0, 0), w = 0, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> [1]  4 10    calc_LRs_w(c(0, 0), c(0, 1), w = 0, p = c(0.25, 0.25, 0.5)) #> [1] 4 0 calc_LRs_w(c(0, 0), c(0, 1), w = 1e-5, p = c(0.25, 0.25, 0.5)) #> [1] 3.9999199992 0.0001199928 calc_LRs_w(c(0, 0), c(0, 1), w = 1e-3, p = c(0.25, 0.25, 0.5)) #> [1] 3.99199202 0.01192834"},{"path":"/reference/calc_LRs_wDwS.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate LR for a profile for one error probability, $w$ — calc_LRs_wDwS","title":"Calculate LR for a profile for one error probability, $w$ — calc_LRs_wDwS","text":"Calculate LR profile one error probability, $w$","code":""},{"path":"/reference/calc_LRs_wDwS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate LR for a profile for one error probability, $w$ — calc_LRs_wDwS","text":"","code":"calc_LRs_wDwS(xs, xd, wD, wS, p)"},{"path":"/reference/calc_LRs_wDwS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate LR for a profile for one error probability, $w$ — calc_LRs_wDwS","text":"xs profile suspect (0, 1, 2) xd profile case (0, 1, 2) wD error probability donor sample wS error probability PoI sample p list genotype probabilities (length xd/xs, vector length 3 reuse)","code":""},{"path":"/reference/calc_LRs_wDwS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate LR for a profile for one error probability, $w$ — calc_LRs_wDwS","text":"","code":"calc_LRs_wDwS(c(0, 0), c(0, 0), wD = 0, wS = 0, p = c(0.25, 0.25, 0.5)) #> [1] 4 4 calc_LRs_w(c(0, 0), c(0, 0), w = 0, p = c(0.25, 0.25, 0.5)) #> [1] 4 4  calc_LRs_wDwS(c(0, 0), c(0, 0), wD = 0, wS = 0, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> [1]  4 10 calc_LRs_w(c(0, 0), c(0, 0), w = 0, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> [1]  4 10    calc_LRs_wDwS(c(0, 0), c(0, 1), wD = 0, wS = 0, p = c(0.25, 0.25, 0.5)) #> [1] 4 0  calc_LRs_wDwS(c(0, 0), c(0, 1), wD = 1e-5, wS = 1e-5, p = c(0.25, 0.25, 0.5)) #> [1] 3.9999199992 0.0001199928 calc_LRs_w(c(0, 0), c(0, 1), w = 1e-5, p = c(0.25, 0.25, 0.5)) #> [1] 3.9999199992 0.0001199928  calc_LRs_wDwS(c(0, 0), c(0, 1), wD = 1e-3, wS = 1e-3, p = c(0.25, 0.25, 0.5)) #> [1] 3.99199202 0.01192834 calc_LRs_w(c(0, 0), c(0, 1), w = 1e-3, p = c(0.25, 0.25, 0.5)) #> [1] 3.99199202 0.01192834  calc_LRs_wDwS(c(0, 0), c(0, 1), wD = 1e-2, wS = 1e-6, p = c(0.25, 0.25, 0.5)) #> [1] 3.95919624 0.07618684 calc_LRs_w(c(0, 0), c(0, 1), w = 5e-3, p = c(0.25, 0.25, 0.5)) #> [1] 3.959802 0.058242"},{"path":"/reference/calc_LRs_wTwR.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate LR for a profile for sample-specific error probabilities — calc_LRs_wTwR","title":"Calculate LR for a profile for sample-specific error probabilities — calc_LRs_wTwR","text":"Calculate LR profile sample-specific error probabilities","code":""},{"path":"/reference/calc_LRs_wTwR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate LR for a profile for sample-specific error probabilities — calc_LRs_wTwR","text":"","code":"calc_LRs_wTwR(xT, xR, wT, wR, p)"},{"path":"/reference/calc_LRs_wTwR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate LR for a profile for sample-specific error probabilities — calc_LRs_wTwR","text":"xT profile case (0, 1, 2) xR profile suspect (0, 1, 2) wT error probability donor sample wR error probability PoI sample p list genotype probabilities (length xT/xR, vector length 3 reuse)","code":""},{"path":"/reference/calc_LRs_wTwR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate LR for a profile for sample-specific error probabilities — calc_LRs_wTwR","text":"","code":"calc_LRs_wTwR(c(0, 0), c(0, 0), wT = 0, wR = 0, p = c(0.25, 0.25, 0.5)) #> [1] 4 4 calc_LRs_w(c(0, 0), c(0, 0), w = 0, p = c(0.25, 0.25, 0.5)) #> [1] 4 4  calc_LRs_wTwR(c(0, 0), c(0, 0), wT = 0, wR = 0, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> [1]  4 10 calc_LRs_w(c(0, 0), c(0, 0), w = 0, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> [1]  4 10    calc_LRs_wTwR(c(0, 0), c(0, 1), wT = 0, wR = 0, p = c(0.25, 0.25, 0.5)) #> [1] 4 0  calc_LRs_wTwR(c(0, 0), c(0, 1), wT = 1e-5, wR = 1e-5, p = c(0.25, 0.25, 0.5)) #> [1] 3.9999199992 0.0001199928 calc_LRs_w(c(0, 0), c(0, 1), w = 1e-5, p = c(0.25, 0.25, 0.5)) #> [1] 3.9999199992 0.0001199928  calc_LRs_wTwR(c(0, 0), c(0, 1), wT = 1e-3, wR = 1e-3, p = c(0.25, 0.25, 0.5)) #> [1] 3.99199202 0.01192834 calc_LRs_w(c(0, 0), c(0, 1), w = 1e-3, p = c(0.25, 0.25, 0.5)) #> [1] 3.99199202 0.01192834  calc_LRs_wTwR(c(0, 0), c(0, 1), wT = 1e-2, wR = 1e-6, p = c(0.25, 0.25, 0.5)) #> [1] 3.9591962 0.0399996 calc_LRs_w(c(0, 0), c(0, 1), w = 5e-3, p = c(0.25, 0.25, 0.5)) #> [1] 3.959802 0.058242"},{"path":"/reference/calc_LRs_wTwR_integrate_wT.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using exact integration — calc_LRs_wTwR_integrate_wT","title":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using exact integration — calc_LRs_wTwR_integrate_wT","text":"NOTE: Unless reason, please use calc_LRs_wTwR_integrate_wT() instead.","code":""},{"path":"/reference/calc_LRs_wTwR_integrate_wT.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using exact integration — calc_LRs_wTwR_integrate_wT","text":"","code":"calc_LRs_wTwR_integrate_wT(   xT,   xR,   shape1T_H1,   shape2T_H1,   shape1T_H2,   shape2T_H2,   wR,   p,   use_mpfr = TRUE,   stop_on_infinite = TRUE,   mpfr_precision = 256 )"},{"path":"/reference/calc_LRs_wTwR_integrate_wT.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using exact integration — calc_LRs_wTwR_integrate_wT","text":"xT profile case (0, 1, 2) xR profile suspect (0, 1, 2) shape1T_H1 $H_1$ ($LR$'s numerator), wT beta prior (0, 0.5) parameters shape1T_H1 shape2T_H1 shape2T_H1 see shape1T_Hp shape1T_H2 $H_2$ ($LR$'s denominator), wT beta prior (0-0.5) parameters shape1T_H2 shape2T_H2 shape2T_H2 see shape1T_H2 wR error probability PoI sample p list genotype probabilities (length xT/xR, vector length 3 reuse) use_mpfr use higher precision numbers via Rmpfr package stop_on_infinite stop infinite numbers encountered (, try use_mpfr = TRUE) mpfr_precision number bits use","code":""},{"path":"/reference/calc_LRs_wTwR_integrate_wT.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using exact integration — calc_LRs_wTwR_integrate_wT","text":"","code":"calc_LRs_wTwR(xT = c(0, 0), xR = c(0, 1), wT = 1e-2, wR = 1e-5, p = c(0.25, 0.25, 0.5)) #> [1] 3.95916097 0.04006872  shpD <- get_beta_parameters(mu = 1e-2, sigmasq = 2*1e-3, a = 0, b = 0.5) calc_LRs_wTwR_integrate_wT_mc(   xT = c(0, 0),    xR = c(0, 1),    shape1D = shpD[1], shape2D = shpD[2],    wR = 1e-5,    p = c(0.25, 0.25, 0.5),   n_samples = 100) #> Error in calc_LRs_wTwR_integrate_wT_mc(xT = c(0, 0), xR = c(0, 1), shape1D = shpD[1],     shape2D = shpD[2], wR = 1e-05, p = c(0.25, 0.25, 0.5), n_samples = 100): unused arguments (shape1D = shpD[1], shape2D = shpD[2]) calc_LRs_wTwR_integrate_wT_num(   xT = c(0, 0),    xR = c(0, 1),    shape1D = shpD[1], shape2D = shpD[2],    wR = 1e-5,    p = c(0.25, 0.25, 0.5)) #> Error in f(x, ...): unused arguments (shape1D = 0.029, shape2D = 1.421) # curve(dbeta05(x, shpD[1], shpD[2]), from = 0, to = 0.5)  calc_LRs_wTwR_integrate_wT_mc(   xT = c(0, 0),    xR = c(0, 1),    shape1D = 1, shape2D = 1,    wR = 1e-5,    p = c(0.25, 0.25, 0.5),   n_samples = 100) #> Error in calc_LRs_wTwR_integrate_wT_mc(xT = c(0, 0), xR = c(0, 1), shape1D = 1,     shape2D = 1, wR = 1e-05, p = c(0.25, 0.25, 0.5), n_samples = 100): unused arguments (shape1D = 1, shape2D = 1) calc_LRs_wTwR_integrate_wT_num(   xT = c(0, 0),   xR = c(0, 1),   shape1D = 1, shape2D = 1,   wR = 1e-5,   p = c(0.25, 0.25, 0.5),   n_samples = 100) #> Error in f(x, ...): unused arguments (shape1D = 1, shape2D = 1, n_samples = 100) # curve(dbeta05(x, 1, 1), from = 0, to = 0.5)"},{"path":"/reference/calc_LRs_wTwR_integrate_wT_mc.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using Monte Carlo integration — calc_LRs_wTwR_integrate_wT_mc","title":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using Monte Carlo integration — calc_LRs_wTwR_integrate_wT_mc","text":"Calculate LR profile sample-specific error probabilities integrated donor prior distribution using Monte Carlo integration","code":""},{"path":"/reference/calc_LRs_wTwR_integrate_wT_mc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using Monte Carlo integration — calc_LRs_wTwR_integrate_wT_mc","text":"","code":"calc_LRs_wTwR_integrate_wT_mc(   xT,   xR,   shape1T_H1,   shape2T_H1,   shape1T_H2,   shape2T_H2,   wR,   p,   n_samples = 1000 )"},{"path":"/reference/calc_LRs_wTwR_integrate_wT_mc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using Monte Carlo integration — calc_LRs_wTwR_integrate_wT_mc","text":"xT profile case (0, 1, 2) xR profile suspect (0, 1, 2) shape1T_H1 $H_1$ ($LR$'s numerator), wT beta prior (0, 0.5) parameters shape1T_H1 shape2T_H1 shape2T_H1 see shape1T_Hp shape1T_H2 $H_2$ ($LR$'s denominator), wT beta prior (0-0.5) parameters shape1T_H2 shape2T_H2 shape2T_H2 see shape1T_H2 wR error probability PoI sample p list genotype probabilities (length xT/xR, vector length 3 reuse) n_samples number random samples prior distribution","code":""},{"path":"/reference/calc_LRs_wTwR_integrate_wT_mc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using Monte Carlo integration — calc_LRs_wTwR_integrate_wT_mc","text":"","code":"calc_LRs_wTwR(xT = c(0, 0), xR = c(0, 1), wT = 1e-2, wR = 1e-5, p = c(0.25, 0.25, 0.5)) #> [1] 3.95916097 0.04006872  shpD <- get_beta_parameters(mu = 1e-2, sigmasq = 2*1e-3, a = 0, b = 0.5) calc_LRs_wTwR_integrate_wT_mc(   xT = c(0, 0),    xR = c(0, 1),    shape1D = shpD[1], shape2D = shpD[2],    wR = 1e-5,    p = c(0.25, 0.25, 0.5),   n_samples = 100) #> Error in calc_LRs_wTwR_integrate_wT_mc(xT = c(0, 0), xR = c(0, 1), shape1D = shpD[1],     shape2D = shpD[2], wR = 1e-05, p = c(0.25, 0.25, 0.5), n_samples = 100): unused arguments (shape1D = shpD[1], shape2D = shpD[2]) # curve(dbeta05(x, shpD[1], shpD[2]), from = 0, to = 0.5) calc_LRs_wTwR_integrate_wT_mc(   xT = c(0, 0),    xR = c(0, 1),    shape1D = 1, shape2D = 1,    wR = 1e-5,    p = c(0.25, 0.25, 0.5),   n_samples = 100) #> Error in calc_LRs_wTwR_integrate_wT_mc(xT = c(0, 0), xR = c(0, 1), shape1D = 1,     shape2D = 1, wR = 1e-05, p = c(0.25, 0.25, 0.5), n_samples = 100): unused arguments (shape1D = 1, shape2D = 1) # curve(dbeta05(x, 1, 1), from = 0, to = 0.5)    shpS <- get_beta_parameters(mu = 1e-5, sigmasq = 1e-7, a = 0, b = 0.5) integrate(function(x) dbeta05(x, shape1 = shpS[1L], shape2 = shpS[2L]), lower = 1e-12, upper = 0.5, rel.tol = 1e-6) #> 1 with absolute error < 6e-07 calc_LRs_wTwR_integrate_wTwR_mc(   xT = c(0, 0),    xR = c(0, 1),    shape1D = shpD[1], shape2D = shpD[2],    shape1S = shpS[1], shape2S = shpS[2],    p = c(0.25, 0.25, 0.5),   n_samples = 100) #> Error in calc_LRs_wTwR_integrate_wTwR_mc(xT = c(0, 0), xR = c(0, 1), shape1D = shpD[1],     shape2D = shpD[2], shape1S = shpS[1], shape2S = shpS[2],     p = c(0.25, 0.25, 0.5), n_samples = 100): could not find function \"calc_LRs_wTwR_integrate_wTwR_mc\" # curve(dbeta05(x, shpS[1], shpS[2]), from = 0, to = 0.5)"},{"path":"/reference/calc_LRs_wTwR_integrate_wT_num.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using numerical integration — calc_LRs_wTwR_integrate_wT_num","title":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using numerical integration — calc_LRs_wTwR_integrate_wT_num","text":"NOTE: Unless reason, please use calc_LRs_wTwR_integrate_wT() instead.","code":""},{"path":"/reference/calc_LRs_wTwR_integrate_wT_num.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using numerical integration — calc_LRs_wTwR_integrate_wT_num","text":"","code":"calc_LRs_wTwR_integrate_wT_num(   xT,   xR,   shape1T_H1,   shape2T_H1,   shape1T_H2,   shape2T_H2,   wR,   p,   lower_int = 0,   ... )"},{"path":"/reference/calc_LRs_wTwR_integrate_wT_num.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using numerical integration — calc_LRs_wTwR_integrate_wT_num","text":"xT profile case (0, 1, 2) xR profile suspect (0, 1, 2) shape1T_H1 $H_1$ ($LR$'s numerator), wT beta prior (0, 0.5) parameters shape1T_H1 shape2T_H1 shape2T_H1 see shape1T_Hp shape1T_H2 $H_2$ ($LR$'s denominator), wT beta prior (0-0.5) parameters shape1T_H2 shape2T_H2 shape2T_H2 see shape1T_H2 wR error probability PoI sample p list genotype probabilities (length xT/xR, vector length 3 reuse) lower_int lowest value integrate ; 0, numerical instability can make problematic ... pass integrate(), e.g., rel.tol abs.tol","code":""},{"path":"/reference/calc_LRs_wTwR_integrate_wT_num.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate LR for a profile for sample-specific error probabilities integrated over the donor prior distribution using numerical integration — calc_LRs_wTwR_integrate_wT_num","text":"","code":"calc_LRs_wTwR(xT = c(0, 0), xR = c(0, 1), wT = 1e-2, wR = 1e-5, p = c(0.25, 0.25, 0.5)) #> [1] 3.95916097 0.04006872  shpD <- get_beta_parameters(mu = 1e-2, sigmasq = 2*1e-3, a = 0, b = 0.5) calc_LRs_wTwR_integrate_wT_mc(   xT = c(0, 0),    xR = c(0, 1),    shape1D = shpD[1], shape2D = shpD[2],    wR = 1e-5,    p = c(0.25, 0.25, 0.5),   n_samples = 100) #> Error in calc_LRs_wTwR_integrate_wT_mc(xT = c(0, 0), xR = c(0, 1), shape1D = shpD[1],     shape2D = shpD[2], wR = 1e-05, p = c(0.25, 0.25, 0.5), n_samples = 100): unused arguments (shape1D = shpD[1], shape2D = shpD[2]) calc_LRs_wTwR_integrate_wT_num(   xT = c(0, 0),    xR = c(0, 1),    shape1D = shpD[1], shape2D = shpD[2],    wR = 1e-5,    p = c(0.25, 0.25, 0.5)) #> Error in f(x, ...): unused arguments (shape1D = 0.029, shape2D = 1.421) # curve(dbeta05(x, shpD[1], shpD[2]), from = 0, to = 0.5)  calc_LRs_wTwR_integrate_wT_mc(   xT = c(0, 0),    xR = c(0, 1),    shape1D = 1, shape2D = 1,    wR = 1e-5,    p = c(0.25, 0.25, 0.5),   n_samples = 100) #> Error in calc_LRs_wTwR_integrate_wT_mc(xT = c(0, 0), xR = c(0, 1), shape1D = 1,     shape2D = 1, wR = 1e-05, p = c(0.25, 0.25, 0.5), n_samples = 100): unused arguments (shape1D = 1, shape2D = 1) calc_LRs_wTwR_integrate_wT_num(   xT = c(0, 0),   xR = c(0, 1),   shape1D = 1, shape2D = 1,   wR = 1e-5,   p = c(0.25, 0.25, 0.5),   n_samples = 100) #> Error in f(x, ...): unused arguments (shape1D = 1, shape2D = 1, n_samples = 100) # curve(dbeta05(x, 1, 1), from = 0, to = 0.5)"},{"path":"/reference/d_LR_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas for LR grouped by $X^D$ and $X^S$ for one error probability, $w$ — d_LR_w","title":"Formulas for LR grouped by $X^D$ and $X^S$ for one error probability, $w$ — d_LR_w","text":"Formulas LR grouped $X^D$ $X^S$ one error probability, $w$","code":""},{"path":"/reference/d_LR_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas for LR grouped by $X^D$ and $X^S$ for one error probability, $w$ — d_LR_w","text":"","code":"d_LR_w"},{"path":"/reference/d_LR_w.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas for LR grouped by $X^D$ and $X^S$ for one error probability, $w$ — d_LR_w","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_LR_wTwR.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas for LR grouped by $X^D$ and $X^S$ for sample-dependent error probabilities, $w_t$ and $w_r$ — d_LR_wTwR","title":"Formulas for LR grouped by $X^D$ and $X^S$ for sample-dependent error probabilities, $w_t$ and $w_r$ — d_LR_wTwR","text":"Formulas LR grouped $X^D$ $X^S$ sample-dependent error probabilities, $w_t$ $w_r$","code":""},{"path":"/reference/d_LR_wTwR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas for LR grouped by $X^D$ and $X^S$ for sample-dependent error probabilities, $w_t$ and $w_r$ — d_LR_wTwR","text":"","code":"d_LR_wTwR"},{"path":"/reference/d_LR_wTwR.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas for LR grouped by $X^D$ and $X^S$ for sample-dependent error probabilities, $w_t$ and $w_r$ — d_LR_wTwR","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_formulas_Hd.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumeration of possibilities under Hd — d_formulas_Hd","title":"Enumeration of possibilities under Hd — d_formulas_Hd","text":"Enumeration possibilities Hd","code":""},{"path":"/reference/d_formulas_Hd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumeration of possibilities under Hd — d_formulas_Hd","text":"","code":"d_formulas_Hd"},{"path":"/reference/d_formulas_Hd.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Enumeration of possibilities under Hd — d_formulas_Hd","text":"object class tbl_df (inherits tbl, data.frame) 256 rows 20 columns.","code":""},{"path":"/reference/d_formulas_Hd_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumeration of possibilities under Hd for one error probability, $w$ — d_formulas_Hd_w","title":"Enumeration of possibilities under Hd for one error probability, $w$ — d_formulas_Hd_w","text":"Enumeration possibilities Hd one error probability, $w$","code":""},{"path":"/reference/d_formulas_Hd_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumeration of possibilities under Hd for one error probability, $w$ — d_formulas_Hd_w","text":"","code":"d_formulas_Hd_w"},{"path":"/reference/d_formulas_Hd_w.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Enumeration of possibilities under Hd for one error probability, $w$ — d_formulas_Hd_w","text":"object class tbl_df (inherits tbl, data.frame) 256 rows 20 columns.","code":""},{"path":"/reference/d_formulas_Hd_wDwS.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumeration of possibilities under Hd for sample-dependent error probabilities, $w_D$ and $w_S$ — d_formulas_Hd_wDwS","title":"Enumeration of possibilities under Hd for sample-dependent error probabilities, $w_D$ and $w_S$ — d_formulas_Hd_wDwS","text":"Enumeration possibilities Hd sample-dependent error probabilities, $w_D$ $w_S$","code":""},{"path":"/reference/d_formulas_Hd_wDwS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumeration of possibilities under Hd for sample-dependent error probabilities, $w_D$ and $w_S$ — d_formulas_Hd_wDwS","text":"","code":"d_formulas_Hd_wDwS"},{"path":"/reference/d_formulas_Hd_wDwS.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Enumeration of possibilities under Hd for sample-dependent error probabilities, $w_D$ and $w_S$ — d_formulas_Hd_wDwS","text":"object class tbl_df (inherits tbl, data.frame) 256 rows 24 columns.","code":""},{"path":"/reference/d_formulas_Hd_wTwR.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumeration of possibilities under Hd for sample-dependent error probabilities, $w_t$ and $w_r$ — d_formulas_Hd_wTwR","title":"Enumeration of possibilities under Hd for sample-dependent error probabilities, $w_t$ and $w_r$ — d_formulas_Hd_wTwR","text":"Enumeration possibilities Hd sample-dependent error probabilities, $w_t$ $w_r$","code":""},{"path":"/reference/d_formulas_Hd_wTwR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumeration of possibilities under Hd for sample-dependent error probabilities, $w_t$ and $w_r$ — d_formulas_Hd_wTwR","text":"","code":"d_formulas_Hd_wTwR"},{"path":"/reference/d_formulas_Hd_wTwR.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Enumeration of possibilities under Hd for sample-dependent error probabilities, $w_t$ and $w_r$ — d_formulas_Hd_wTwR","text":"object class tbl_df (inherits tbl, data.frame) 256 rows 24 columns.","code":""},{"path":"/reference/d_formulas_Hp.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumeration of possibilities under Hp — d_formulas_Hp","title":"Enumeration of possibilities under Hp — d_formulas_Hp","text":"Enumeration possibilities Hp","code":""},{"path":"/reference/d_formulas_Hp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumeration of possibilities under Hp — d_formulas_Hp","text":"","code":"d_formulas_Hp"},{"path":"/reference/d_formulas_Hp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Enumeration of possibilities under Hp — d_formulas_Hp","text":"object class tbl_df (inherits tbl, data.frame) 64 rows 16 columns.","code":""},{"path":"/reference/d_formulas_Hp_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumeration of possibilities under Hp for one error probability, $w$ — d_formulas_Hp_w","title":"Enumeration of possibilities under Hp for one error probability, $w$ — d_formulas_Hp_w","text":"Enumeration possibilities Hp one error probability, $w$","code":""},{"path":"/reference/d_formulas_Hp_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumeration of possibilities under Hp for one error probability, $w$ — d_formulas_Hp_w","text":"","code":"d_formulas_Hp_w"},{"path":"/reference/d_formulas_Hp_w.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Enumeration of possibilities under Hp for one error probability, $w$ — d_formulas_Hp_w","text":"object class tbl_df (inherits tbl, data.frame) 64 rows 16 columns.","code":""},{"path":"/reference/d_formulas_Hp_wDwS.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumeration of possibilities under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — d_formulas_Hp_wDwS","title":"Enumeration of possibilities under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — d_formulas_Hp_wDwS","text":"Enumeration possibilities Hp sample-dependent error probabilities, $w_D$ $w_S$","code":""},{"path":"/reference/d_formulas_Hp_wDwS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumeration of possibilities under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — d_formulas_Hp_wDwS","text":"","code":"d_formulas_Hp_wDwS"},{"path":"/reference/d_formulas_Hp_wDwS.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Enumeration of possibilities under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — d_formulas_Hp_wDwS","text":"object class tbl_df (inherits tbl, data.frame) 64 rows 20 columns.","code":""},{"path":"/reference/d_formulas_Hp_wTwR.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumeration of possibilities under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — d_formulas_Hp_wTwR","title":"Enumeration of possibilities under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — d_formulas_Hp_wTwR","text":"Enumeration possibilities Hp sample-dependent error probabilities, $w_t$ $w_r$","code":""},{"path":"/reference/d_formulas_Hp_wTwR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumeration of possibilities under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — d_formulas_Hp_wTwR","text":"","code":"d_formulas_Hp_wTwR"},{"path":"/reference/d_formulas_Hp_wTwR.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Enumeration of possibilities under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — d_formulas_Hp_wTwR","text":"object class tbl_df (inherits tbl, data.frame) 64 rows 20 columns.","code":""},{"path":"/reference/d_formulas_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Enumeration of possibilities for single observation — d_formulas_single","title":"Enumeration of possibilities for single observation — d_formulas_single","text":"Enumeration possibilities single observation","code":""},{"path":"/reference/d_formulas_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enumeration of possibilities for single observation — d_formulas_single","text":"","code":"d_formulas_single"},{"path":"/reference/d_formulas_single.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Enumeration of possibilities for single observation — d_formulas_single","text":"object class tbl_df (inherits tbl, data.frame) 16 rows 11 columns.","code":""},{"path":"/reference/d_prob_Hd.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas under Hd grouped by XD and XS — d_prob_Hd","title":"Formulas under Hd grouped by XD and XS — d_prob_Hd","text":"Formulas Hd grouped XD XS","code":""},{"path":"/reference/d_prob_Hd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas under Hd grouped by XD and XS — d_prob_Hd","text":"","code":"d_prob_Hd"},{"path":"/reference/d_prob_Hd.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas under Hd grouped by XD and XS — d_prob_Hd","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_prob_Hd_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas under Hd grouped by $X^D$ and $X^S$ for one error probability, $w$ — d_prob_Hd_w","title":"Formulas under Hd grouped by $X^D$ and $X^S$ for one error probability, $w$ — d_prob_Hd_w","text":"Formulas Hd grouped $X^D$ $X^S$ one error probability, $w$","code":""},{"path":"/reference/d_prob_Hd_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas under Hd grouped by $X^D$ and $X^S$ for one error probability, $w$ — d_prob_Hd_w","text":"","code":"d_prob_Hd_w"},{"path":"/reference/d_prob_Hd_w.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas under Hd grouped by $X^D$ and $X^S$ for one error probability, $w$ — d_prob_Hd_w","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_prob_Hd_wDwS.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas under Hd grouped by XD and XS for sample-dependent error probabilities, $w_D$ and $w_S$ — d_prob_Hd_wDwS","title":"Formulas under Hd grouped by XD and XS for sample-dependent error probabilities, $w_D$ and $w_S$ — d_prob_Hd_wDwS","text":"Formulas Hd grouped XD XS sample-dependent error probabilities, $w_D$ $w_S$","code":""},{"path":"/reference/d_prob_Hd_wDwS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas under Hd grouped by XD and XS for sample-dependent error probabilities, $w_D$ and $w_S$ — d_prob_Hd_wDwS","text":"","code":"d_prob_Hd_wDwS"},{"path":"/reference/d_prob_Hd_wDwS.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas under Hd grouped by XD and XS for sample-dependent error probabilities, $w_D$ and $w_S$ — d_prob_Hd_wDwS","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_prob_Hd_wTwR.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas under Hd grouped by $X^D$ and $X^S$ for sample-dependent error probabilities, $w_t$ and $w_r$ — d_prob_Hd_wTwR","title":"Formulas under Hd grouped by $X^D$ and $X^S$ for sample-dependent error probabilities, $w_t$ and $w_r$ — d_prob_Hd_wTwR","text":"Formulas Hd grouped $X^D$ $X^S$ sample-dependent error probabilities, $w_t$ $w_r$","code":""},{"path":"/reference/d_prob_Hd_wTwR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas under Hd grouped by $X^D$ and $X^S$ for sample-dependent error probabilities, $w_t$ and $w_r$ — d_prob_Hd_wTwR","text":"","code":"d_prob_Hd_wTwR"},{"path":"/reference/d_prob_Hd_wTwR.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas under Hd grouped by $X^D$ and $X^S$ for sample-dependent error probabilities, $w_t$ and $w_r$ — d_prob_Hd_wTwR","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_prob_Hp.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas under Hp grouped by XD and XS — d_prob_Hp","title":"Formulas under Hp grouped by XD and XS — d_prob_Hp","text":"Formulas Hp grouped XD XS","code":""},{"path":"/reference/d_prob_Hp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas under Hp grouped by XD and XS — d_prob_Hp","text":"","code":"d_prob_Hp"},{"path":"/reference/d_prob_Hp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas under Hp grouped by XD and XS — d_prob_Hp","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_prob_Hp_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas under Hp grouped by $X^D$ and $X^S$ for one error probability, $w$ — d_prob_Hp_w","title":"Formulas under Hp grouped by $X^D$ and $X^S$ for one error probability, $w$ — d_prob_Hp_w","text":"Formulas Hp grouped $X^D$ $X^S$ one error probability, $w$","code":""},{"path":"/reference/d_prob_Hp_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas under Hp grouped by $X^D$ and $X^S$ for one error probability, $w$ — d_prob_Hp_w","text":"","code":"d_prob_Hp_w"},{"path":"/reference/d_prob_Hp_w.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas under Hp grouped by $X^D$ and $X^S$ for one error probability, $w$ — d_prob_Hp_w","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_prob_Hp_wDwS.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas under Hp grouped by XD and XS for sample-dependent error probabilities, $w_D$ and $w_S$ — d_prob_Hp_wDwS","title":"Formulas under Hp grouped by XD and XS for sample-dependent error probabilities, $w_D$ and $w_S$ — d_prob_Hp_wDwS","text":"Formulas Hp grouped XD XS sample-dependent error probabilities, $w_D$ $w_S$","code":""},{"path":"/reference/d_prob_Hp_wDwS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas under Hp grouped by XD and XS for sample-dependent error probabilities, $w_D$ and $w_S$ — d_prob_Hp_wDwS","text":"","code":"d_prob_Hp_wDwS"},{"path":"/reference/d_prob_Hp_wDwS.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas under Hp grouped by XD and XS for sample-dependent error probabilities, $w_D$ and $w_S$ — d_prob_Hp_wDwS","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_prob_Hp_wTwR.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas under Hp grouped by $X^D$ and $X^S$ for sample-dependent error probabilities, $w_t$ and $w_r$ — d_prob_Hp_wTwR","title":"Formulas under Hp grouped by $X^D$ and $X^S$ for sample-dependent error probabilities, $w_t$ and $w_r$ — d_prob_Hp_wTwR","text":"Formulas Hp grouped $X^D$ $X^S$ sample-dependent error probabilities, $w_t$ $w_r$","code":""},{"path":"/reference/d_prob_Hp_wTwR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas under Hp grouped by $X^D$ and $X^S$ for sample-dependent error probabilities, $w_t$ and $w_r$ — d_prob_Hp_wTwR","text":"","code":"d_prob_Hp_wTwR"},{"path":"/reference/d_prob_Hp_wTwR.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas under Hp grouped by $X^D$ and $X^S$ for sample-dependent error probabilities, $w_t$ and $w_r$ — d_prob_Hp_wTwR","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_prob_LR.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas for LR grouped by XD and XS — d_prob_LR","title":"Formulas for LR grouped by XD and XS — d_prob_LR","text":"Formulas LR grouped XD XS","code":""},{"path":"/reference/d_prob_LR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas for LR grouped by XD and XS — d_prob_LR","text":"","code":"d_prob_LR"},{"path":"/reference/d_prob_LR.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas for LR grouped by XD and XS — d_prob_LR","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_prob_LR_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas for LR grouped by XD and XS for one error probability, $w$ — d_prob_LR_w","title":"Formulas for LR grouped by XD and XS for one error probability, $w$ — d_prob_LR_w","text":"Formulas LR grouped XD XS one error probability, $w$","code":""},{"path":"/reference/d_prob_LR_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas for LR grouped by XD and XS for one error probability, $w$ — d_prob_LR_w","text":"","code":"d_prob_LR_w"},{"path":"/reference/d_prob_LR_w.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas for LR grouped by XD and XS for one error probability, $w$ — d_prob_LR_w","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_prob_LR_wDwS.html","id":null,"dir":"Reference","previous_headings":"","what":"Formulas for LR grouped by XD and XS for sample-dependent error probabilities, $w_D$ and $w_S$ — d_prob_LR_wDwS","title":"Formulas for LR grouped by XD and XS for sample-dependent error probabilities, $w_D$ and $w_S$ — d_prob_LR_wDwS","text":"Formulas LR grouped XD XS sample-dependent error probabilities, $w_D$ $w_S$","code":""},{"path":"/reference/d_prob_LR_wDwS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formulas for LR grouped by XD and XS for sample-dependent error probabilities, $w_D$ and $w_S$ — d_prob_LR_wDwS","text":"","code":"d_prob_LR_wDwS"},{"path":"/reference/d_prob_LR_wDwS.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Formulas for LR grouped by XD and XS for sample-dependent error probabilities, $w_D$ and $w_S$ — d_prob_LR_wDwS","text":"object class rowwise_df (inherits tbl_df, tbl, data.frame) 9 rows 5 columns.","code":""},{"path":"/reference/d_probtable_Hd.html","id":null,"dir":"Reference","previous_headings":"","what":"Probabilties for efficient sampling under Hd — d_probtable_Hd","title":"Probabilties for efficient sampling under Hd — d_probtable_Hd","text":"Probabilties efficient sampling Hd","code":""},{"path":"/reference/d_probtable_Hd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probabilties for efficient sampling under Hd — d_probtable_Hd","text":"","code":"d_probtable_Hd"},{"path":"/reference/d_probtable_Hd.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Probabilties for efficient sampling under Hd — d_probtable_Hd","text":"object class data.frame 256 rows 13 columns.","code":""},{"path":"/reference/d_probtable_Hd_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Probabilties for efficient sampling under Hd for one error probability, $w$ — d_probtable_Hd_w","title":"Probabilties for efficient sampling under Hd for one error probability, $w$ — d_probtable_Hd_w","text":"Probabilties efficient sampling Hd one error probability, $w$","code":""},{"path":"/reference/d_probtable_Hd_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probabilties for efficient sampling under Hd for one error probability, $w$ — d_probtable_Hd_w","text":"","code":"d_probtable_Hd_w"},{"path":"/reference/d_probtable_Hd_w.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Probabilties for efficient sampling under Hd for one error probability, $w$ — d_probtable_Hd_w","text":"object class data.frame 256 rows 13 columns.","code":""},{"path":"/reference/d_probtable_Hd_wDwS.html","id":null,"dir":"Reference","previous_headings":"","what":"Probabilties for efficient sampling under Hd for one error probability, $w$ — d_probtable_Hd_wDwS","title":"Probabilties for efficient sampling under Hd for one error probability, $w$ — d_probtable_Hd_wDwS","text":"Probabilties efficient sampling Hd one error probability, $w$","code":""},{"path":"/reference/d_probtable_Hd_wDwS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probabilties for efficient sampling under Hd for one error probability, $w$ — d_probtable_Hd_wDwS","text":"","code":"d_probtable_Hd_wDwS"},{"path":"/reference/d_probtable_Hd_wDwS.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Probabilties for efficient sampling under Hd for one error probability, $w$ — d_probtable_Hd_wDwS","text":"object class data.frame 256 rows 13 columns.","code":""},{"path":"/reference/d_probtable_Hd_wTwR.html","id":null,"dir":"Reference","previous_headings":"","what":"Probabilties for efficient sampling under Hd for one error probability, $w$ — d_probtable_Hd_wTwR","title":"Probabilties for efficient sampling under Hd for one error probability, $w$ — d_probtable_Hd_wTwR","text":"Probabilties efficient sampling Hd one error probability, $w$","code":""},{"path":"/reference/d_probtable_Hd_wTwR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probabilties for efficient sampling under Hd for one error probability, $w$ — d_probtable_Hd_wTwR","text":"","code":"d_probtable_Hd_wTwR"},{"path":"/reference/d_probtable_Hd_wTwR.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Probabilties for efficient sampling under Hd for one error probability, $w$ — d_probtable_Hd_wTwR","text":"object class data.frame 256 rows 13 columns.","code":""},{"path":"/reference/d_probtable_Hp.html","id":null,"dir":"Reference","previous_headings":"","what":"Probabilties for efficient sampling under Hp — d_probtable_Hp","title":"Probabilties for efficient sampling under Hp — d_probtable_Hp","text":"Probabilties efficient sampling Hp","code":""},{"path":"/reference/d_probtable_Hp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probabilties for efficient sampling under Hp — d_probtable_Hp","text":"","code":"d_probtable_Hp"},{"path":"/reference/d_probtable_Hp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Probabilties for efficient sampling under Hp — d_probtable_Hp","text":"object class data.frame 64 rows 9 columns.","code":""},{"path":"/reference/d_probtable_Hp_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Probabilties for efficient sampling under Hp for one error probability, $w$ — d_probtable_Hp_w","title":"Probabilties for efficient sampling under Hp for one error probability, $w$ — d_probtable_Hp_w","text":"Probabilties efficient sampling Hp one error probability, $w$","code":""},{"path":"/reference/d_probtable_Hp_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probabilties for efficient sampling under Hp for one error probability, $w$ — d_probtable_Hp_w","text":"","code":"d_probtable_Hp_w"},{"path":"/reference/d_probtable_Hp_w.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Probabilties for efficient sampling under Hp for one error probability, $w$ — d_probtable_Hp_w","text":"object class data.frame 64 rows 9 columns.","code":""},{"path":"/reference/d_probtable_Hp_wDwS.html","id":null,"dir":"Reference","previous_headings":"","what":"Probabilties for efficient sampling under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — d_probtable_Hp_wDwS","title":"Probabilties for efficient sampling under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — d_probtable_Hp_wDwS","text":"Probabilties efficient sampling Hp sample-dependent error probabilities, $w_D$ $w_S$","code":""},{"path":"/reference/d_probtable_Hp_wDwS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probabilties for efficient sampling under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — d_probtable_Hp_wDwS","text":"","code":"d_probtable_Hp_wDwS"},{"path":"/reference/d_probtable_Hp_wDwS.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Probabilties for efficient sampling under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — d_probtable_Hp_wDwS","text":"object class data.frame 64 rows 9 columns.","code":""},{"path":"/reference/d_probtable_Hp_wTwR.html","id":null,"dir":"Reference","previous_headings":"","what":"Probabilties for efficient sampling under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — d_probtable_Hp_wTwR","title":"Probabilties for efficient sampling under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — d_probtable_Hp_wTwR","text":"Probabilties efficient sampling Hp sample-dependent error probabilities, $w_t$ $w_r$","code":""},{"path":"/reference/d_probtable_Hp_wTwR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Probabilties for efficient sampling under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — d_probtable_Hp_wTwR","text":"","code":"d_probtable_Hp_wTwR"},{"path":"/reference/d_probtable_Hp_wTwR.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Probabilties for efficient sampling under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — d_probtable_Hp_wTwR","text":"object class data.frame 64 rows 9 columns.","code":""},{"path":"/reference/estimate_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate error probability, w — estimate_w","title":"Estimate error probability, w — estimate_w","text":"Note tol = .Machine$double.eps unless overwritten.","code":""},{"path":"/reference/estimate_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate error probability, w — estimate_w","text":"","code":"estimate_w(x, use_mpfr = FALSE, ...)"},{"path":"/reference/estimate_w.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate error probability, w — estimate_w","text":"x either 3x3 contingency table 3-vector counts (n1, n2, n3) n1 = sum(diag(x)), n2 = x[1L, 3L] + x[3L, 1L], n3 = sum(x) - n1 - n2 use_mpfr whether use Rmpfr::optimizeR()] arbitrary precision ... passed optimise() Rmpfr::optimizeR use_mpfr = TRUE","code":""},{"path":"/reference/estimate_w.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate error probability, w — estimate_w","text":"","code":"tab1 <- matrix(c(1000, 10, 2, 12, 100, 8, 1, 7, 200), nrow = 3) tab1 #>      [,1] [,2] [,3] #> [1,] 1000   12    1 #> [2,]   10  100    7 #> [3,]    2    8  200 estimate_w(tab1) #> [1] 0.008154441 n1 <- sum(diag(tab1)) n2 <- tab1[1L, 3L] + tab1[3L, 1L] n3 <- sum(tab1) - n1 - n2 estimate_w(c(n1, n2, n3)) #> [1] 0.008154441  tab2 <- structure(c(40000L, 30L, 5L, 15L, 400L, 2L, 5L, 5L, 350L),         dim = c(3L, 3L), class = \"table\") tab2 #>      [,1]  [,2]  [,3]  #> [1,] 40000    15     5 #> [2,]    30   400     5 #> [3,]     5     2   350 estimate_w(tab2) #> [1] 0.0004414364 estimate_w(tab2, use_mpfr = TRUE) #> 1 'mpfr' number of precision  132   bits  #> [1] 0.00044143635878284077344503195817562240248647"},{"path":"/reference/estimate_w_bayesian.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate error probability, w, using a Bayesian approach — estimate_w_bayesian","title":"Estimate error probability, w, using a Bayesian approach — estimate_w_bayesian","text":"Beta prior assumed. Note $w$ assumed $< 0.5$.","code":""},{"path":"/reference/estimate_w_bayesian.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate error probability, w, using a Bayesian approach — estimate_w_bayesian","text":"","code":"estimate_w_bayesian(   x,   prior_a = 1,   prior_b = 1,   chains = 4,   chains_function = lapply,   warmup = 1000,   iterations = 10000,   ... )"},{"path":"/reference/estimate_w_bayesian.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate error probability, w, using a Bayesian approach — estimate_w_bayesian","text":"x either 3x3 contingency table 3-vector counts (n1, n2, n3) n1 = sum(diag(x)), n2 = x[1L, 3L] + x[3L, 1L], n3 = sum(x) - n1 - n2 prior_a First shape parameter prior beta distribution prior_b Second shape parameter prior beta distribution iterations Number iterations ... used","code":""},{"path":"/reference/estimate_w_bayesian.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate error probability, w, using a Bayesian approach — estimate_w_bayesian","text":"NOTE: recommend using e.g. cmdstanr, see vignette. just implementation demonstrate Bayesian approach.","code":""},{"path":"/reference/estimate_w_bayesian.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate error probability, w, using a Bayesian approach — estimate_w_bayesian","text":"","code":"tab1 <- matrix(c(1000, 10, 2, 12, 100, 8, 1, 7, 200), nrow = 3) tab1 #>      [,1] [,2] [,3] #> [1,] 1000   12    1 #> [2,]   10  100    7 #> [3,]    2    8  200 estimate_w(tab1) #> [1] 0.008154441 y <- estimate_w_bayesian(tab1) q <- posterior_samples(y) mean(q); #plot(q, type = \"l\"); hist(q) #> [1] 0.008415182 sapply(y, \\(x) x$acceptance_ratio) #> [1] 0.2154 0.2173 0.2139 0.2177  estimate_w_bayesian(c(750, 0, 0), chains = 1, warmup = 0, iterations = 500) |>     lapply(\\(x) x$samples) |> unlist() |> plot(type = \"l\")   estimate_w(c(750, 0, 0)) #> [1] 9.733533e-17 y <- estimate_w_bayesian(c(750, 0, 0)); q <- lapply(y, \\(x) x$samples) |> unlist() mean(q); #plot(q, type = \"l\"); hist(q) #> [1] 0.0003226629 sapply(y, \\(x) x$acceptance_ratio) #> [1] 0.0642 0.0620 0.0618 0.0624"},{"path":"/reference/estimate_w_se.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate standard error of error probability, w — estimate_w_se","title":"Estimate standard error of error probability, w — estimate_w_se","text":"Note relies Hessian approximation returned numDeriv::hessian().","code":""},{"path":"/reference/estimate_w_se.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate standard error of error probability, w — estimate_w_se","text":"","code":"estimate_w_se(x, w, method.args = list())"},{"path":"/reference/estimate_w_se.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate standard error of error probability, w — estimate_w_se","text":"w estimated error probability w method.args see numDeriv::grad()","code":""},{"path":"/reference/estimate_w_se.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate standard error of error probability, w — estimate_w_se","text":"","code":"x <- matrix(c(1000, 10, 2, 12, 100, 8, 1, 7, 200), nrow = 3) x #>      [,1] [,2] [,3] #> [1,] 1000   12    1 #> [2,]   10  100    7 #> [3,]    2    8  200 w <- estimate_w(x) w #> [1] 0.008154441 estimate_w_se(x, w) #> [1] 0.001248947"},{"path":"/reference/extract_profile.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract profile from ranked markers — extract_profile","title":"Extract profile from ranked markers — extract_profile","text":"Uses recent marker ranking (see function argument).","code":""},{"path":"/reference/extract_profile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract profile from ranked markers — extract_profile","text":"","code":"extract_profile(x, markers = marker_candidates_v1)"},{"path":"/reference/extract_profile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract profile from ranked markers — extract_profile","text":"x Data (potentially already filtered), including columns chr pos markers Marker ranking","code":""},{"path":"/reference/extract_profile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract profile from ranked markers — extract_profile","text":"Original data extra columns segment, segment_no rank","code":""},{"path":"/reference/extract_profile.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract profile from ranked markers — extract_profile","text":"NOTE: check reference alternative alleles . See examples one way inspect .","code":""},{"path":"/reference/extract_profile.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract profile from ranked markers — extract_profile","text":"","code":"vcf <- vcf_example_data_v1 |> rename(chr = CHROM, pos = POS) #> Error: object 'vcf_example_data_v1' not found prof <- extract_profile(vcf) #> Error: object 'vcf' not found head(prof) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'prof' not found nrow(prof) #> Error: object 'prof' not found table(prof$rank) #> Error: object 'prof' not found  # Also using allele frequencies from `marker_candidates_v1` prof_extra_info <- prof |> inner_join(marker_candidates_v1 |>    select(chr, pos, ref, alt, AF_afr, AF_eas, AF_nfe), by = c(\"chr\", \"pos\")) #> Error: object 'prof' not found head(prof_extra_info) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'prof_extra_info' not found  subset(prof_extra_info, ref != REF) #> Error: object 'prof_extra_info' not found subset(prof_extra_info, alt != ALT) #> Error: object 'prof_extra_info' not found subset(prof_extra_info, alt != ALT & ALT != \"?\") #> Error: object 'prof_extra_info' not found  X <- to012(prof_extra_info$GT) #> Error: object 'prof_extra_info' not found X #> Error: object 'X' not found genoprob <- allele_probs_to_geno_probs(prof_extra_info$AF_nfe) #> Error: object 'prof_extra_info' not found  LRs <- calc_LRs(xT = X, xR = X, w = 0.01, p = genoprob) #> Error in calc_LRs(xT = X, xR = X, w = 0.01, p = genoprob): could not find function \"calc_LRs\" WoE <- sum(log10(LRs)) #> Error: object 'LRs' not found WoE #> Error: object 'WoE' not found  ws <- 10^(-(6:1)) LRs_ws <- sapply(ws, \\(w) sum(log10(calc_LRs(xT = X, xR = X, w = w, p = genoprob)))) #> Error in calc_LRs(xT = X, xR = X, w = w, p = genoprob): could not find function \"calc_LRs\" cbind(ws, LRs_ws) #> Error: object 'LRs_ws' not found  # Assume two errors head(X) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'X' not found XD <- X #> Error: object 'X' not found XD[1] <- 1 #> Error: object 'XD' not found XD[2] <- 1 #> Error: object 'XD' not found LRs_ws_Xd <- sapply(ws, \\(w) sum(log10(calc_LRs(xT = XD, xR = X, w = w, p = genoprob)))) #> Error in calc_LRs(xT = XD, xR = X, w = w, p = genoprob): could not find function \"calc_LRs\" cbind(ws, LRs_ws_Xd) #> Error: object 'LRs_ws_Xd' not found  # Assume two more errors head(X) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'X' not found XD[3] <- 0 #> Error: object 'XD' not found XD[4] <- 0 #> Error: object 'XD' not found LRs_ws_Xd4 <- sapply(ws, \\(w) sum(log10(calc_LRs(xT = XD, xR = X, w = w, p = genoprob)))) #> Error in calc_LRs(xT = XD, xR = X, w = w, p = genoprob): could not find function \"calc_LRs\" cbind(ws, LRs_ws_Xd4) #> Error: object 'LRs_ws_Xd4' not found"},{"path":"/reference/extract_profile_v1.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract profile — extract_profile_v1","title":"Extract profile — extract_profile_v1","text":"Uses marker_candidates_v1 ranking.","code":""},{"path":"/reference/extract_profile_v1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract profile — extract_profile_v1","text":"","code":"extract_profile_v1(x)"},{"path":"/reference/extract_profile_v1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract profile — extract_profile_v1","text":"x Data (potentially already filtered), including columns chr pos","code":""},{"path":"/reference/extract_profile_v1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract profile — extract_profile_v1","text":"","code":"vcf <- vcf_example_data_v1 |> rename(chr = CHROM, pos = POS) #> Error: object 'vcf_example_data_v1' not found prof <- extract_profile(vcf) #> Error: object 'vcf' not found head(prof) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'prof' not found nrow(prof) #> Error: object 'prof' not found table(prof$rank) #> Error: object 'prof' not found  # Also using allele frequencies from `marker_candidates_v1` prof_extra_info <- prof |> inner_join(marker_candidates_v1 |>    select(chr, pos, ref, alt, AF_afr, AF_eas, AF_nfe), by = c(\"chr\", \"pos\")) #> Error: object 'prof' not found head(prof_extra_info) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'prof_extra_info' not found  subset(prof_extra_info, ref != REF) #> Error: object 'prof_extra_info' not found subset(prof_extra_info, alt != ALT) #> Error: object 'prof_extra_info' not found subset(prof_extra_info, alt != ALT & ALT != \"?\") #> Error: object 'prof_extra_info' not found  X <- to012(prof_extra_info$GT) #> Error: object 'prof_extra_info' not found X #> Error: object 'X' not found genoprob <- allele_probs_to_geno_probs(prof_extra_info$AF_nfe) #> Error: object 'prof_extra_info' not found  LRs <- calc_LRs(xT = X, xR = X, w = 0.01, p = genoprob) #> Error in calc_LRs(xT = X, xR = X, w = 0.01, p = genoprob): could not find function \"calc_LRs\" WoE <- sum(log10(LRs)) #> Error: object 'LRs' not found WoE #> Error: object 'WoE' not found  ws <- 10^(-(6:1)) LRs_ws <- sapply(ws, \\(w) sum(log10(calc_LRs(xT = X, xR = X, w = w, p = genoprob)))) #> Error in calc_LRs(xT = X, xR = X, w = w, p = genoprob): could not find function \"calc_LRs\" cbind(ws, LRs_ws) #> Error: object 'LRs_ws' not found  # Assume two errors head(X) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'X' not found XD <- X #> Error: object 'X' not found XD[1] <- 1 #> Error: object 'XD' not found XD[2] <- 1 #> Error: object 'XD' not found LRs_ws_Xd <- sapply(ws, \\(w) sum(log10(calc_LRs(xT = XD, xR = X, w = w, p = genoprob)))) #> Error in calc_LRs(xT = XD, xR = X, w = w, p = genoprob): could not find function \"calc_LRs\" cbind(ws, LRs_ws_Xd) #> Error: object 'LRs_ws_Xd' not found  # Assume two more errors head(X) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': object 'X' not found XD[3] <- 0 #> Error: object 'XD' not found XD[4] <- 0 #> Error: object 'XD' not found LRs_ws_Xd4 <- sapply(ws, \\(w) sum(log10(calc_LRs(xT = XD, xR = X, w = w, p = genoprob)))) #> Error in calc_LRs(xT = XD, xR = X, w = w, p = genoprob): could not find function \"calc_LRs\" cbind(ws, LRs_ws_Xd4) #> Error: object 'LRs_ws_Xd4' not found"},{"path":"/reference/get_beta_mu_sigma.html","id":null,"dir":"Reference","previous_headings":"","what":"Parameterisation conversion for beta distribution — get_beta_mu_sigma","title":"Parameterisation conversion for beta distribution — get_beta_mu_sigma","text":"Get beta distribution's mean variance.","code":""},{"path":"/reference/get_beta_mu_sigma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parameterisation conversion for beta distribution — get_beta_mu_sigma","text":"","code":"get_beta_mu_sigma(shape1, shape2, a = 0, b = 0.5)"},{"path":"/reference/get_beta_mu_sigma.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parameterisation conversion for beta distribution — get_beta_mu_sigma","text":"shape1 first shape parameter shape2 second shape parameter lower support bound b upper support bound","code":""},{"path":"/reference/get_beta_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Parameterisation conversion for beta distribution — get_beta_parameters","title":"Parameterisation conversion for beta distribution — get_beta_parameters","text":"Get beta distribution's two shape parameters mean value variance.","code":""},{"path":"/reference/get_beta_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parameterisation conversion for beta distribution — get_beta_parameters","text":"","code":"get_beta_parameters(mu, sigmasq, a = 0, b = 0.5)"},{"path":"/reference/get_beta_parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parameterisation conversion for beta distribution — get_beta_parameters","text":"mu mean value sigmasq variance lower support bound b upper support bound","code":""},{"path":"/reference/get_beta_parameters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parameterisation conversion for beta distribution — get_beta_parameters","text":"","code":"a <- 2 b <- 6 m <- a / (a + b) v <- (a*b)/((a+b)^2 * (a + b +1)) get_beta_parameters(m, v) #> [1] 1 1 get_beta_parameters(1e-2, 1e-3) #> [1] 0.078 3.822 # p <- get_beta_parameters(0.1, 0.01); curve(dbeta(x, p[1], p[2]), from = 0, to = 1) # p <- get_beta_parameters(0.1, 0.001); curve(dbeta(x, p[1], p[2]), from = 0, to = 1) # p <- get_beta_parameters(0.1, 0.0001); curve(dbeta(x, p[1], p[2]), from = 0, to = 1)  s12 <- get_beta_parameters(mu = 1e-2, sigmasq = 1e-3, a = 0, b = 0.5) x <- rbeta05(1000, s12[1L], s12[2L]) mean(x); var(x) #> [1] 0.01035644 #> [1] 0.001002918  s12 <- get_beta_parameters(mu = 1e-5, sigmasq = 1e-7, a = 0, b = 0.5) x <- rbeta05(10000, s12[1L], s12[2L]) mean(x); var(x) #> [1] 7.08732e-06 #> [1] 3.425107e-08"},{"path":"/reference/get_ns.html","id":null,"dir":"Reference","previous_headings":"","what":"Get counts from table — get_ns","title":"Get counts from table — get_ns","text":"Get counts table","code":""},{"path":"/reference/get_ns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get counts from table — get_ns","text":"","code":"get_ns(x)"},{"path":"/reference/graph_Hd.html","id":null,"dir":"Reference","previous_headings":"","what":"Graph for enumeration of possibilities under Hd — graph_Hd","title":"Graph for enumeration of possibilities under Hd — graph_Hd","text":"Graph enumeration possibilities Hd","code":""},{"path":"/reference/graph_Hd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Graph for enumeration of possibilities under Hd — graph_Hd","text":"","code":"graph_Hd"},{"path":"/reference/graph_Hd.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Graph for enumeration of possibilities under Hd — graph_Hd","text":"object class tbl_graph (inherits igraph) length 10.","code":""},{"path":"/reference/graph_Hd_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Graph for enumeration of possibilities under Hd for one error probability, $w$ — graph_Hd_w","title":"Graph for enumeration of possibilities under Hd for one error probability, $w$ — graph_Hd_w","text":"Graph enumeration possibilities Hd one error probability, $w$","code":""},{"path":"/reference/graph_Hd_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Graph for enumeration of possibilities under Hd for one error probability, $w$ — graph_Hd_w","text":"","code":"graph_Hd_w"},{"path":"/reference/graph_Hd_w.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Graph for enumeration of possibilities under Hd for one error probability, $w$ — graph_Hd_w","text":"object class tbl_graph (inherits igraph) length 10.","code":""},{"path":"/reference/graph_Hd_wDwS.html","id":null,"dir":"Reference","previous_headings":"","what":"Graph for enumeration of possibilities under Hd for sample-dependent error probabilities, $w_D$ and $w_S$ — graph_Hd_wDwS","title":"Graph for enumeration of possibilities under Hd for sample-dependent error probabilities, $w_D$ and $w_S$ — graph_Hd_wDwS","text":"Graph enumeration possibilities Hd sample-dependent error probabilities, $w_D$ $w_S$","code":""},{"path":"/reference/graph_Hd_wDwS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Graph for enumeration of possibilities under Hd for sample-dependent error probabilities, $w_D$ and $w_S$ — graph_Hd_wDwS","text":"","code":"graph_Hd_wDwS"},{"path":"/reference/graph_Hd_wDwS.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Graph for enumeration of possibilities under Hd for sample-dependent error probabilities, $w_D$ and $w_S$ — graph_Hd_wDwS","text":"object class tbl_graph (inherits igraph) length 10.","code":""},{"path":"/reference/graph_Hd_wTwR.html","id":null,"dir":"Reference","previous_headings":"","what":"Graph for enumeration of possibilities under Hd for sample-dependent error probabilities, $w_t$ and $w_r$ — graph_Hd_wTwR","title":"Graph for enumeration of possibilities under Hd for sample-dependent error probabilities, $w_t$ and $w_r$ — graph_Hd_wTwR","text":"Graph enumeration possibilities Hd sample-dependent error probabilities, $w_t$ $w_r$","code":""},{"path":"/reference/graph_Hd_wTwR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Graph for enumeration of possibilities under Hd for sample-dependent error probabilities, $w_t$ and $w_r$ — graph_Hd_wTwR","text":"","code":"graph_Hd_wTwR"},{"path":"/reference/graph_Hd_wTwR.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Graph for enumeration of possibilities under Hd for sample-dependent error probabilities, $w_t$ and $w_r$ — graph_Hd_wTwR","text":"object class tbl_graph (inherits igraph) length 10.","code":""},{"path":"/reference/graph_Hp.html","id":null,"dir":"Reference","previous_headings":"","what":"Graph for enumeration of possibilities under Hp — graph_Hp","title":"Graph for enumeration of possibilities under Hp — graph_Hp","text":"Graph enumeration possibilities Hp","code":""},{"path":"/reference/graph_Hp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Graph for enumeration of possibilities under Hp — graph_Hp","text":"","code":"graph_Hp"},{"path":"/reference/graph_Hp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Graph for enumeration of possibilities under Hp — graph_Hp","text":"object class tbl_graph (inherits igraph) length 10.","code":""},{"path":"/reference/graph_Hp_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Graph for enumeration of possibilities under Hp for one error probability, $w$ — graph_Hp_w","title":"Graph for enumeration of possibilities under Hp for one error probability, $w$ — graph_Hp_w","text":"Graph enumeration possibilities Hp one error probability, $w$","code":""},{"path":"/reference/graph_Hp_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Graph for enumeration of possibilities under Hp for one error probability, $w$ — graph_Hp_w","text":"","code":"graph_Hp_w"},{"path":"/reference/graph_Hp_w.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Graph for enumeration of possibilities under Hp for one error probability, $w$ — graph_Hp_w","text":"object class tbl_graph (inherits igraph) length 10.","code":""},{"path":"/reference/graph_Hp_wDwS.html","id":null,"dir":"Reference","previous_headings":"","what":"Graph for enumeration of possibilities under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — graph_Hp_wDwS","title":"Graph for enumeration of possibilities under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — graph_Hp_wDwS","text":"Graph enumeration possibilities Hp sample-dependent error probabilities, $w_D$ $w_S$","code":""},{"path":"/reference/graph_Hp_wDwS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Graph for enumeration of possibilities under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — graph_Hp_wDwS","text":"","code":"graph_Hp_wDwS"},{"path":"/reference/graph_Hp_wDwS.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Graph for enumeration of possibilities under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — graph_Hp_wDwS","text":"object class tbl_graph (inherits igraph) length 10.","code":""},{"path":"/reference/graph_Hp_wTwR.html","id":null,"dir":"Reference","previous_headings":"","what":"Graph for enumeration of possibilities under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — graph_Hp_wTwR","title":"Graph for enumeration of possibilities under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — graph_Hp_wTwR","text":"Graph enumeration possibilities Hp sample-dependent error probabilities, $w_t$ $w_r$","code":""},{"path":"/reference/graph_Hp_wTwR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Graph for enumeration of possibilities under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — graph_Hp_wTwR","text":"","code":"graph_Hp_wTwR"},{"path":"/reference/graph_Hp_wTwR.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Graph for enumeration of possibilities under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — graph_Hp_wTwR","text":"object class tbl_graph (inherits igraph) length 10.","code":""},{"path":"/reference/graph_single.html","id":null,"dir":"Reference","previous_headings":"","what":"Graph for enumeration of possibilities for single observation — graph_single","title":"Graph for enumeration of possibilities for single observation — graph_single","text":"Graph enumeration possibilities single observation","code":""},{"path":"/reference/graph_single.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Graph for enumeration of possibilities for single observation — graph_single","text":"","code":"graph_single"},{"path":"/reference/graph_single.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Graph for enumeration of possibilities for single observation — graph_single","text":"object class tbl_graph (inherits igraph) length 10.","code":""},{"path":"/reference/marker_candidates_v1.html","id":null,"dir":"Reference","previous_headings":"","what":"Marker candidates (v1) — marker_candidates_v1","title":"Marker candidates (v1) — marker_candidates_v1","text":"Data Genome Aggregation Database (gnomAD) binary SNP loci rs names, .e., rs column starts rs, one character ref column one character alt column.","code":""},{"path":"/reference/marker_candidates_v1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Marker candidates (v1) — marker_candidates_v1","text":"","code":"marker_candidates_v1"},{"path":"/reference/marker_candidates_v1.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Marker candidates (v1) — marker_candidates_v1","text":"object class tbl_df (inherits tbl, data.frame) 4128 rows 23 columns.","code":""},{"path":"/reference/marker_candidates_v1.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Marker candidates (v1) — marker_candidates_v1","text":"https://gnomad.broadinstitute.org/","code":""},{"path":"/reference/marker_candidates_v1.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Marker candidates (v1) — marker_candidates_v1","text":"loci filtered MAF values AFR, EAS, NFE populations. MAF values must within 0.1, 0.15, 0.2 0.5.","code":""},{"path":"/reference/posterior_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract posterior samples — posterior_samples","title":"Extract posterior samples — posterior_samples","text":"Extract posterior samples","code":""},{"path":"/reference/posterior_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract posterior samples — posterior_samples","text":"","code":"posterior_samples(x)"},{"path":"/reference/posterior_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract posterior samples — posterior_samples","text":"x Result estimate_w_bayesian()","code":""},{"path":"/reference/posterior_samples.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract posterior samples — posterior_samples","text":"","code":"tab1 <- matrix(c(1000, 10, 2, 12, 100, 8, 1, 7, 200), nrow = 3) tab1 #>      [,1] [,2] [,3] #> [1,] 1000   12    1 #> [2,]   10  100    7 #> [3,]    2    8  200 y <- estimate_w_bayesian(tab1) q <- posterior_samples(y) mean(q); #plot(q, type = \"l\"); hist(q) #> [1] 0.008422582"},{"path":"/reference/reuse_genotype_probs.html","id":null,"dir":"Reference","previous_headings":"","what":"Re-use genotype probabilities — reuse_genotype_probs","title":"Re-use genotype probabilities — reuse_genotype_probs","text":"p <- c(0.2, 0.7, 0.1) to012(sample_profiles_without_error(n = 2, p = p))","code":""},{"path":"/reference/reuse_genotype_probs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Re-use genotype probabilities — reuse_genotype_probs","text":"","code":"reuse_genotype_probs(p, n)"},{"path":"/reference/reuse_genotype_probs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Re-use genotype probabilities — reuse_genotype_probs","text":"p_10loci <- reuse_genotype_probs(p, 10) to012(sample_profiles_without_error(n = 2, p = p_10loci))","code":""},{"path":"/reference/sample_data_Hd.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cases under Hd — sample_data_Hd","title":"Sample cases under Hd — sample_data_Hd","text":"One latent genotype, ZD, true donor (D) one latent genotype, ZS, suspect (S).","code":""},{"path":"/reference/sample_data_Hd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cases under Hd — sample_data_Hd","text":"","code":"sample_data_Hd(n, w, p)"},{"path":"/reference/sample_data_Hd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cases under Hd — sample_data_Hd","text":"n number samples w error probability p list genotype probabilities (length number loci) vector length 3 single locus","code":""},{"path":"/reference/sample_data_Hd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cases under Hd — sample_data_Hd","text":"list two matrices, size n x loci genotype 0/1/2 format resembling situation real life.","code":""},{"path":"/reference/sample_data_Hd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample cases under Hd — sample_data_Hd","text":"","code":"sample_data_Hd(n = 10, w = 0.3, p = c(0.25, 0.25, 0.5)) #> $X_D #>       [,1] #>  [1,]    2 #>  [2,]    2 #>  [3,]    1 #>  [4,]    0 #>  [5,]    1 #>  [6,]    0 #>  [7,]    0 #>  [8,]    0 #>  [9,]    2 #> [10,]    1 #>  #> $X_S #>       [,1] #>  [1,]    2 #>  [2,]    0 #>  [3,]    2 #>  [4,]    2 #>  [5,]    0 #>  [6,]    2 #>  [7,]    1 #>  [8,]    0 #>  [9,]    0 #> [10,]    1 #>  sample_data_Hd(n = 10, w = 0.1, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> $X_D #>       [,1] [,2] #>  [1,]    1    1 #>  [2,]    1    0 #>  [3,]    0    1 #>  [4,]    1    1 #>  [5,]    0    0 #>  [6,]    0    1 #>  [7,]    1    2 #>  [8,]    2    1 #>  [9,]    2    0 #> [10,]    1    0 #>  #> $X_S #>       [,1] [,2] #>  [1,]    1    0 #>  [2,]    2    1 #>  [3,]    1    0 #>  [4,]    2    2 #>  [5,]    0    1 #>  [6,]    1    1 #>  [7,]    0    0 #>  [8,]    2    1 #>  [9,]    2    1 #> [10,]    1    0 #>     cases <- sample_data_Hd(n = 1000, w = 0, p = c(0.25, 0.25, 0.5)) tab <- table(cases$X_D, cases$X_S) tab #>     #>       0   1   2 #>   0 162  49 191 #>   1  43  16  60 #>   2 196  57 226"},{"path":"/reference/sample_data_Hd_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cases under Hd for one error probability, $w$ — sample_data_Hd_w","title":"Sample cases under Hd for one error probability, $w$ — sample_data_Hd_w","text":"One latent genotype, ZD, true donor (D) one latent genotype, ZS, suspect (S).","code":""},{"path":"/reference/sample_data_Hd_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cases under Hd for one error probability, $w$ — sample_data_Hd_w","text":"","code":"sample_data_Hd_w(n, w, p, ...)"},{"path":"/reference/sample_data_Hd_w.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cases under Hd for one error probability, $w$ — sample_data_Hd_w","text":"n number samples w error probability p list genotype probabilities (length number loci) vector length 3 single locus ... Passed add_errors_to_genotypes()","code":""},{"path":"/reference/sample_data_Hd_w.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cases under Hd for one error probability, $w$ — sample_data_Hd_w","text":"list two matrices, size n x loci genotype 0/1/2 format resembling situation real life.","code":""},{"path":"/reference/sample_data_Hd_w.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample cases under Hd for one error probability, $w$ — sample_data_Hd_w","text":"","code":"sample_data_Hd_w(n = 10, w = 0.3, p = c(0.25, 0.25, 0.5)) #> $xT #>       [,1] #>  [1,]    1 #>  [2,]    1 #>  [3,]    1 #>  [4,]    0 #>  [5,]    2 #>  [6,]    1 #>  [7,]    0 #>  [8,]    1 #>  [9,]    0 #> [10,]    1 #>  #> $xR #>       [,1] #>  [1,]    1 #>  [2,]    2 #>  [3,]    2 #>  [4,]    1 #>  [5,]    2 #>  [6,]    0 #>  [7,]    2 #>  [8,]    2 #>  [9,]    1 #> [10,]    2 #>  sample_data_Hd_w(n = 10, w = 0.1, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> $xT #>       [,1] [,2] #>  [1,]    1    2 #>  [2,]    0    0 #>  [3,]    2    1 #>  [4,]    2    1 #>  [5,]    0    1 #>  [6,]    1    0 #>  [7,]    0    1 #>  [8,]    0    1 #>  [9,]    2    1 #> [10,]    2    1 #>  #> $xR #>       [,1] [,2] #>  [1,]    0    1 #>  [2,]    2    2 #>  [3,]    1    1 #>  [4,]    1    1 #>  [5,]    0    1 #>  [6,]    2    1 #>  [7,]    0    1 #>  [8,]    2    1 #>  [9,]    1    2 #> [10,]    0    1 #>     cases <- sample_data_Hd_w(n = 1000, w = 0, p = c(0.25, 0.25, 0.5)) tab <- table(xT = cases$xT, xR = cases$xR) tab #>    xR #> xT    0   1   2 #>   0  61  59 122 #>   1  72  54 118 #>   2 129 128 257"},{"path":"/reference/sample_data_Hd_wDwS.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cases under Hd for sample-dependent error probabilities, $w_D$ and $w_S$ — sample_data_Hd_wDwS","title":"Sample cases under Hd for sample-dependent error probabilities, $w_D$ and $w_S$ — sample_data_Hd_wDwS","text":"One latent genotype, ZD, true donor (D) one latent genotype, ZS, suspect (S).","code":""},{"path":"/reference/sample_data_Hd_wDwS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cases under Hd for sample-dependent error probabilities, $w_D$ and $w_S$ — sample_data_Hd_wDwS","text":"","code":"sample_data_Hd_wDwS(n, wD, wS, p, ...)"},{"path":"/reference/sample_data_Hd_wDwS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cases under Hd for sample-dependent error probabilities, $w_D$ and $w_S$ — sample_data_Hd_wDwS","text":"n number samples wD error probability donor sample wS error probability PoI sample p list genotype probabilities (length number loci) vector length 3 single locus ... Passed add_errors_to_genotypes()","code":""},{"path":"/reference/sample_data_Hd_wDwS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cases under Hd for sample-dependent error probabilities, $w_D$ and $w_S$ — sample_data_Hd_wDwS","text":"list two matrices, size n x loci genotype 0/1/2 format resembling situation real life.","code":""},{"path":"/reference/sample_data_Hd_wDwS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample cases under Hd for sample-dependent error probabilities, $w_D$ and $w_S$ — sample_data_Hd_wDwS","text":"","code":"sample_data_Hd_wDwS(n = 10, wD = 0.3, wS = 1e-6, p = c(0.25, 0.25, 0.5)) #> $X_D #>       [,1] #>  [1,]    1 #>  [2,]    1 #>  [3,]    0 #>  [4,]    2 #>  [5,]    2 #>  [6,]    1 #>  [7,]    2 #>  [8,]    1 #>  [9,]    0 #> [10,]    1 #>  #> $X_S #>       [,1] #>  [1,]    0 #>  [2,]    2 #>  [3,]    2 #>  [4,]    1 #>  [5,]    2 #>  [6,]    0 #>  [7,]    0 #>  [8,]    2 #>  [9,]    2 #> [10,]    1 #>  sample_data_Hd_wDwS(n = 10, wD = 0.3, wS = 1e-6, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> $X_D #>       [,1] [,2] #>  [1,]    2    1 #>  [2,]    1    1 #>  [3,]    1    1 #>  [4,]    0    0 #>  [5,]    0    1 #>  [6,]    0    2 #>  [7,]    1    0 #>  [8,]    0    0 #>  [9,]    1    1 #> [10,]    2    1 #>  #> $X_S #>       [,1] [,2] #>  [1,]    0    1 #>  [2,]    2    1 #>  [3,]    0    1 #>  [4,]    0    1 #>  [5,]    2    1 #>  [6,]    1    1 #>  [7,]    0    1 #>  [8,]    1    0 #>  [9,]    2    1 #> [10,]    2    1 #>     cases <- sample_data_Hd_wDwS(n = 1000, wD = 1e-1, wS = 1e-8, p = c(0.25, 0.25, 0.5)) tab <- table(X_D = cases$X_D, X_S = cases$X_S) tab #>    X_S #> X_D   0   1   2 #>   0  59  47 103 #>   1  81 101 163 #>   2 103 119 224  cases <- sample_data_Hd_wDwS(n = 1000, wD = 0, wS = 0, p = c(0.25, 0.25, 0.5)) tab <- table(X_D = cases$X_D, X_S = cases$X_S) tab #>    X_S #> X_D   0   1   2 #>   0  55  65 136 #>   1  60  73 131 #>   2 120 125 235"},{"path":"/reference/sample_data_Hd_wTwR.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cases under Hd for sample-dependent error probabilities, $w_t$ and $w_r$ — sample_data_Hd_wTwR","title":"Sample cases under Hd for sample-dependent error probabilities, $w_t$ and $w_r$ — sample_data_Hd_wTwR","text":"One latent genotype, ZD, true donor (D) one latent genotype, ZS, suspect (S).","code":""},{"path":"/reference/sample_data_Hd_wTwR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cases under Hd for sample-dependent error probabilities, $w_t$ and $w_r$ — sample_data_Hd_wTwR","text":"","code":"sample_data_Hd_wTwR(n, wT, wR, p, ...)"},{"path":"/reference/sample_data_Hd_wTwR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cases under Hd for sample-dependent error probabilities, $w_t$ and $w_r$ — sample_data_Hd_wTwR","text":"n number samples wT error probability donor sample wR error probability PoI sample p list genotype probabilities (length number loci) vector length 3 single locus ... Passed add_errors_to_genotypes()","code":""},{"path":"/reference/sample_data_Hd_wTwR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cases under Hd for sample-dependent error probabilities, $w_t$ and $w_r$ — sample_data_Hd_wTwR","text":"list two matrices, size n x loci genotype 0/1/2 format resembling situation real life.","code":""},{"path":"/reference/sample_data_Hd_wTwR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample cases under Hd for sample-dependent error probabilities, $w_t$ and $w_r$ — sample_data_Hd_wTwR","text":"","code":"sample_data_Hd_wTwR(n = 10, wT = 0.3, wR = 1e-6, p = c(0.25, 0.25, 0.5)) #> $xT #>       [,1] #>  [1,]    0 #>  [2,]    2 #>  [3,]    2 #>  [4,]    1 #>  [5,]    1 #>  [6,]    1 #>  [7,]    1 #>  [8,]    1 #>  [9,]    1 #> [10,]    2 #>  #> $xR #>       [,1] #>  [1,]    0 #>  [2,]    2 #>  [3,]    0 #>  [4,]    0 #>  [5,]    1 #>  [6,]    2 #>  [7,]    0 #>  [8,]    0 #>  [9,]    1 #> [10,]    0 #>  sample_data_Hd_wTwR(n = 10, wT = 0.3, wR = 1e-6, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> $xT #>       [,1] [,2] #>  [1,]    2    1 #>  [2,]    2    0 #>  [3,]    0    1 #>  [4,]    0    1 #>  [5,]    0    2 #>  [6,]    2    0 #>  [7,]    0    1 #>  [8,]    1    2 #>  [9,]    1    1 #> [10,]    0    1 #>  #> $xR #>       [,1] [,2] #>  [1,]    2    2 #>  [2,]    2    1 #>  [3,]    1    1 #>  [4,]    2    1 #>  [5,]    2    1 #>  [6,]    2    1 #>  [7,]    0    1 #>  [8,]    1    1 #>  [9,]    1    1 #> [10,]    2    1 #>     cases <- sample_data_Hd_wTwR(n = 1000, wT = 1e-1, wR = 1e-8, p = c(0.25, 0.25, 0.5)) tab <- table(xT = cases$xT, xR = cases$xR) tab #>    xR #> xT    0   1   2 #>   0  62  45  94 #>   1  91  87 165 #>   2 114 122 220  cases <- sample_data_Hd_wTwR(n = 1000, wT = 0, wR = 0, p = c(0.25, 0.25, 0.5)) tab <- table(xT = cases$xT, xR = cases$xR) tab #>    xR #> xT    0   1   2 #>   0  69  68 108 #>   1  64  60 112 #>   2 123 128 268"},{"path":"/reference/sample_data_Hp.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cases under Hp — sample_data_Hp","title":"Sample cases under Hp — sample_data_Hp","text":"latent genotype, Z, independent errors true donor (D) suspect (S).","code":""},{"path":"/reference/sample_data_Hp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cases under Hp — sample_data_Hp","text":"","code":"sample_data_Hp(n, w, p)"},{"path":"/reference/sample_data_Hp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cases under Hp — sample_data_Hp","text":"n number samples w error probability p list genotype probabilities (length number loci) vector length 3 single locus","code":""},{"path":"/reference/sample_data_Hp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cases under Hp — sample_data_Hp","text":"list two matrices, size n x loci genotype 0/1/2 format resembling situation real life.","code":""},{"path":"/reference/sample_data_Hp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample cases under Hp — sample_data_Hp","text":"","code":"sample_data_Hp(n = 10, w = 0.3, p = c(0.25, 0.25, 0.5)) #> $X_D #>       [,1] #>  [1,]    2 #>  [2,]    1 #>  [3,]    1 #>  [4,]    0 #>  [5,]    0 #>  [6,]    2 #>  [7,]    2 #>  [8,]    2 #>  [9,]    2 #> [10,]    1 #>  #> $X_S #>       [,1] #>  [1,]    2 #>  [2,]    0 #>  [3,]    1 #>  [4,]    1 #>  [5,]    1 #>  [6,]    2 #>  [7,]    0 #>  [8,]    2 #>  [9,]    2 #> [10,]    2 #>  sample_data_Hp(n = 10, w = 0.1, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> $X_D #>       [,1] [,2] #>  [1,]    2    2 #>  [2,]    0    1 #>  [3,]    1    2 #>  [4,]    2    0 #>  [5,]    0    2 #>  [6,]    1    1 #>  [7,]    1    1 #>  [8,]    2    0 #>  [9,]    0    0 #> [10,]    1    0 #>  #> $X_S #>       [,1] [,2] #>  [1,]    2    0 #>  [2,]    0    1 #>  [3,]    2    1 #>  [4,]    2    0 #>  [5,]    0    2 #>  [6,]    1    0 #>  [7,]    1    1 #>  [8,]    2    0 #>  [9,]    0    0 #> [10,]    0    0 #>     cases <- sample_data_Hp(n = 1000, w = 0.3, p = c(0.25, 0.25, 0.5)) tab <- table(cases$X_D, cases$X_S) tab #>     #>       0   1   2 #>   0 112  99  44 #>   1 111 192 128 #>   2  35 154 125 estimate_w(tab) #> [1] 0.2838007"},{"path":"/reference/sample_data_Hp_w.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cases under Hp for one error probability, $w$ — sample_data_Hp_w","title":"Sample cases under Hp for one error probability, $w$ — sample_data_Hp_w","text":"latent genotype, Z, independent errors true donor (D) suspect (S).","code":""},{"path":"/reference/sample_data_Hp_w.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cases under Hp for one error probability, $w$ — sample_data_Hp_w","text":"","code":"sample_data_Hp_w(n, w, p, ...)"},{"path":"/reference/sample_data_Hp_w.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cases under Hp for one error probability, $w$ — sample_data_Hp_w","text":"n number samples w error probability p list genotype probabilities (length number loci) vector length 3 single locus ... Passed add_errors_to_genotypes()","code":""},{"path":"/reference/sample_data_Hp_w.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cases under Hp for one error probability, $w$ — sample_data_Hp_w","text":"list two matrices, size n x loci genotype 0/1/2 format resembling situation real life.","code":""},{"path":"/reference/sample_data_Hp_w.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample cases under Hp for one error probability, $w$ — sample_data_Hp_w","text":"","code":"sample_data_Hp_w(n = 10, w = 0.3, p = c(0.25, 0.25, 0.5)) #> $xT #>       [,1] #>  [1,]    0 #>  [2,]    2 #>  [3,]    1 #>  [4,]    2 #>  [5,]    1 #>  [6,]    1 #>  [7,]    0 #>  [8,]    1 #>  [9,]    0 #> [10,]    0 #>  #> $xR #>       [,1] #>  [1,]    1 #>  [2,]    1 #>  [3,]    1 #>  [4,]    1 #>  [5,]    1 #>  [6,]    1 #>  [7,]    0 #>  [8,]    1 #>  [9,]    1 #> [10,]    1 #>  sample_data_Hp_w(n = 10, w = 0.1, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> $xT #>       [,1] [,2] #>  [1,]    2    1 #>  [2,]    1    2 #>  [3,]    0    1 #>  [4,]    1    1 #>  [5,]    1    0 #>  [6,]    2    0 #>  [7,]    2    2 #>  [8,]    2    1 #>  [9,]    2    1 #> [10,]    1    1 #>  #> $xR #>       [,1] [,2] #>  [1,]    2    2 #>  [2,]    1    2 #>  [3,]    0    1 #>  [4,]    2    1 #>  [5,]    1    0 #>  [6,]    2    0 #>  [7,]    1    2 #>  [8,]    2    1 #>  [9,]    1    1 #> [10,]    2    1 #>     cases <- sample_data_Hp_w(n = 1000, w = 0.3, p = c(0.25, 0.25, 0.5)) tab <- table(xT = cases$xT, xR = cases$xR) tab #>    xR #> xT    0   1   2 #>   0  67  92  51 #>   1  98 231 150 #>   2  42 137 132 estimate_w(tab) #> [1] 0.3024808  cases <- sample_data_Hp_w(n = 1000, w = 0, p = c(0.1, 0.7, 0.2)) tab <- table(xT = cases$xT, xR = cases$xR) diag(tab/sum(tab)) #>     0     1     2  #> 0.093 0.708 0.199"},{"path":"/reference/sample_data_Hp_wDwS.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cases under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — sample_data_Hp_wDwS","title":"Sample cases under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — sample_data_Hp_wDwS","text":"latent genotype, Z, independent errors true donor (D) suspect (S).","code":""},{"path":"/reference/sample_data_Hp_wDwS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cases under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — sample_data_Hp_wDwS","text":"","code":"sample_data_Hp_wDwS(n, wD, wS, p, ...)"},{"path":"/reference/sample_data_Hp_wDwS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cases under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — sample_data_Hp_wDwS","text":"n number samples wD error probability donor sample wS error probability PoI sample p list genotype probabilities (length number loci) vector length 3 single locus ... Passed add_errors_to_genotypes()","code":""},{"path":"/reference/sample_data_Hp_wDwS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cases under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — sample_data_Hp_wDwS","text":"list two matrices, size n x loci genotype 0/1/2 format resembling situation real life.","code":""},{"path":"/reference/sample_data_Hp_wDwS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample cases under Hp for sample-dependent error probabilities, $w_D$ and $w_S$ — sample_data_Hp_wDwS","text":"","code":"sample_data_Hp_wDwS(n = 10, wD = 0.3, wS = 1e-6, p = c(0.25, 0.25, 0.5)) #> $X_D #>       [,1] #>  [1,]    1 #>  [2,]    1 #>  [3,]    1 #>  [4,]    0 #>  [5,]    1 #>  [6,]    1 #>  [7,]    2 #>  [8,]    1 #>  [9,]    1 #> [10,]    1 #>  #> $X_S #>       [,1] #>  [1,]    2 #>  [2,]    1 #>  [3,]    1 #>  [4,]    1 #>  [5,]    0 #>  [6,]    2 #>  [7,]    2 #>  [8,]    2 #>  [9,]    0 #> [10,]    0 #>  sample_data_Hp_wDwS(n = 10, wD = 0.3, wS = 1e-6, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> $X_D #>       [,1] [,2] #>  [1,]    2    2 #>  [2,]    1    0 #>  [3,]    0    0 #>  [4,]    1    1 #>  [5,]    1    1 #>  [6,]    2    1 #>  [7,]    1    1 #>  [8,]    1    1 #>  [9,]    2    0 #> [10,]    2    1 #>  #> $X_S #>       [,1] [,2] #>  [1,]    2    1 #>  [2,]    2    1 #>  [3,]    0    1 #>  [4,]    0    1 #>  [5,]    1    1 #>  [6,]    2    1 #>  [7,]    2    1 #>  [8,]    2    1 #>  [9,]    2    1 #> [10,]    2    1 #>     cases <- sample_data_Hp_wDwS(n = 1000, wD = 0, wS = 0, p = c(0.25, 0.25, 0.5)) table(X_D = cases$X_D, X_S = cases$X_S) #>    X_S #> X_D   0   1   2 #>   0 238   0   0 #>   1   0 244   0 #>   2   0   0 518 cases <- sample_data_Hp_wDwS(n = 1000, wD = 0.1, wS = 0, p = c(0.25, 0.25, 0.5)) table(X_D = cases$X_D, X_S = cases$X_S) #>    X_S #> X_D   0   1   2 #>   0 218  20   3 #>   1  39 224  85 #>   2   4  15 392 cases <- sample_data_Hp_wDwS(n = 1000, wD = 0, wS = 0.1, p = c(0.25, 0.25, 0.5)) table(X_D = cases$X_D, X_S = cases$X_S) #>    X_S #> X_D   0   1   2 #>   0 192  47   3 #>   1  16 216  23 #>   2   7 100 396    cases <- sample_data_Hp_wDwS(n = 1000, wD = 1e-1, wS = 1e-8, p = c(0.25, 0.25, 0.5)) tab <- table(X_D = cases$X_D, X_S = cases$X_S) tab #>    X_S #> X_D   0   1   2 #>   0 201  23   4 #>   1  42 184  93 #>   2   0  26 427 estimate_w(tab) #> [1] 0.05340395  cases <- sample_data_Hp_wDwS(n = 1000, wD = 0, wS = 0, p = c(0.1, 0.7, 0.2)) tab <- table(X_D = cases$X_D, X_S = cases$X_S) diag(tab/sum(tab)) #>     0     1     2  #> 0.088 0.693 0.219"},{"path":"/reference/sample_data_Hp_wTwR.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample cases under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — sample_data_Hp_wTwR","title":"Sample cases under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — sample_data_Hp_wTwR","text":"latent genotype, Z, independent errors true donor (D) suspect (S).","code":""},{"path":"/reference/sample_data_Hp_wTwR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample cases under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — sample_data_Hp_wTwR","text":"","code":"sample_data_Hp_wTwR(n, wT, wR, p, ...)"},{"path":"/reference/sample_data_Hp_wTwR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample cases under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — sample_data_Hp_wTwR","text":"n number samples wT error probability donor sample wR error probability PoI sample p list genotype probabilities (length number loci) vector length 3 single locus ... Passed add_errors_to_genotypes()","code":""},{"path":"/reference/sample_data_Hp_wTwR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample cases under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — sample_data_Hp_wTwR","text":"list two matrices, size n x loci genotype 0/1/2 format resembling situation real life.","code":""},{"path":"/reference/sample_data_Hp_wTwR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample cases under Hp for sample-dependent error probabilities, $w_t$ and $w_r$ — sample_data_Hp_wTwR","text":"","code":"sample_data_Hp_wTwR(n = 10, wT = 0.3, wR = 1e-6, p = c(0.25, 0.25, 0.5)) #> $xT #>       [,1] #>  [1,]    0 #>  [2,]    1 #>  [3,]    1 #>  [4,]    1 #>  [5,]    1 #>  [6,]    0 #>  [7,]    1 #>  [8,]    2 #>  [9,]    1 #> [10,]    1 #>  #> $xR #>       [,1] #>  [1,]    2 #>  [2,]    1 #>  [3,]    2 #>  [4,]    1 #>  [5,]    2 #>  [6,]    0 #>  [7,]    1 #>  [8,]    2 #>  [9,]    0 #> [10,]    2 #>  sample_data_Hp_wTwR(n = 10, wT = 0.3, wR = 1e-6, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) #> $xT #>       [,1] [,2] #>  [1,]    1    0 #>  [2,]    2    1 #>  [3,]    1    1 #>  [4,]    0    2 #>  [5,]    1    1 #>  [6,]    0    1 #>  [7,]    2    2 #>  [8,]    2    2 #>  [9,]    0    0 #> [10,]    2    1 #>  #> $xR #>       [,1] [,2] #>  [1,]    1    0 #>  [2,]    2    1 #>  [3,]    1    1 #>  [4,]    0    1 #>  [5,]    2    2 #>  [6,]    0    1 #>  [7,]    2    1 #>  [8,]    2    1 #>  [9,]    0    1 #> [10,]    2    1 #>     cases <- sample_data_Hp_wTwR(n = 1000, wT = 0, wR = 0, p = c(0.25, 0.25, 0.5)) table(xT = cases$xT, xR = cases$xR) #>    xR #> xT    0   1   2 #>   0 253   0   0 #>   1   0 239   0 #>   2   0   0 508 cases <- sample_data_Hp_wTwR(n = 1000, wT = 0.1, wR = 0, p = c(0.25, 0.25, 0.5)) table(xT = cases$xT, xR = cases$xR) #>    xR #> xT    0   1   2 #>   0 178  31   2 #>   1  41 218  93 #>   2   3  20 414 cases <- sample_data_Hp_wTwR(n = 1000, wT = 0, wR = 0.1, p = c(0.25, 0.25, 0.5)) table(xT = cases$xT, xR = cases$xR) #>    xR #> xT    0   1   2 #>   0 197  42   2 #>   1  18 229  24 #>   2   4  95 389    cases <- sample_data_Hp_wTwR(n = 1000, wT = 1e-1, wR = 1e-8, p = c(0.25, 0.25, 0.5)) tab <- table(xT = cases$xT, xR = cases$xR) tab #>    xR #> xT    0   1   2 #>   0 203  19   3 #>   1  54 202 100 #>   2   3  25 391 estimate_w(tab) #> [1] 0.05907991  cases <- sample_data_Hp_wTwR(n = 1000, wT = 0, wR = 0, p = c(0.1, 0.7, 0.2)) tab <- table(xT = cases$xT, xR = cases$xR) diag(tab/sum(tab)) #>     0     1     2  #> 0.100 0.686 0.214"},{"path":"/reference/sample_profiles_without_error.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample genotype without error — sample_profiles_without_error","title":"Sample genotype without error — sample_profiles_without_error","text":"Sample genotype without error","code":""},{"path":"/reference/sample_profiles_without_error.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample genotype without error — sample_profiles_without_error","text":"","code":"sample_profiles_without_error(n, p)"},{"path":"/reference/sample_profiles_without_error.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample genotype without error — sample_profiles_without_error","text":"n number samples p list genotype probabilities vector length 3 single locus","code":""},{"path":"/reference/sample_profiles_without_error.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample genotype without error — sample_profiles_without_error","text":"list, element locus matrix n rows two columns","code":""},{"path":"/reference/sample_profiles_without_error.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample genotype without error — sample_profiles_without_error","text":"","code":"Z <- sample_profiles_without_error(n = 2, p = c(0.25, 0.25, 0.5)) to012(Z) #>      [,1] #> [1,]    2 #> [2,]    1 Z <- sample_profiles_without_error(n = 5, p = list(   c(0.25, 0.25, 0.5), c(0.1, 0.8, 0.1))) Z #> [[1]] #>      [,1] [,2] #> [1,]    0    0 #> [2,]    1    1 #> [3,]    1    1 #> [4,]    1    1 #> [5,]    1    0 #>  #> [[2]] #>      [,1] [,2] #> [1,]    1    0 #> [2,]    0    1 #> [3,]    0    0 #> [4,]    1    0 #> [5,]    1    0 #>  to012(Z) #>      [,1] [,2] #> [1,]    0    1 #> [2,]    2    1 #> [3,]    2    0 #> [4,]    2    1 #> [5,]    1    1"},{"path":"/reference/to012.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert to 0/1/2 notation — to012","title":"Convert to 0/1/2 notation — to012","text":"Can Convert character genotype 0/0, 0/1, 1/0, 1/1 0, 1, 2 notation. Convert haplotypes c(0, 0), c(0, 1), c(1, 0), c(1, 1) 0, 1, 2 notation.","code":""},{"path":"/reference/to012.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert to 0/1/2 notation — to012","text":"","code":"to012(x)"},{"path":"/reference/to012.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert to 0/1/2 notation — to012","text":"x genotypes, e.g. sample_profiles_without_error()","code":""},{"path":"/reference/to012.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert to 0/1/2 notation — to012","text":"Note input list loci, element matrix n x 2 n number individuals. Output n x loci matrix.","code":""},{"path":"/reference/to012.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert to 0/1/2 notation — to012","text":"","code":"to012(c(\"0/0\", \"0/1\", \"1/0\", \"1/1\")) #> [1] 0 1 1 2  Z <- sample_profiles_without_error(n = 10, p = list(   c(0.25, 0.25, 0.5), c(0.01, 0.01, 0.98))) Z #> [[1]] #>       [,1] [,2] #>  [1,]    0    0 #>  [2,]    0    0 #>  [3,]    1    1 #>  [4,]    1    1 #>  [5,]    1    1 #>  [6,]    1    1 #>  [7,]    1    1 #>  [8,]    1    0 #>  [9,]    0    0 #> [10,]    1    1 #>  #> [[2]] #>       [,1] [,2] #>  [1,]    1    1 #>  [2,]    1    1 #>  [3,]    1    1 #>  [4,]    1    1 #>  [5,]    1    1 #>  [6,]    1    1 #>  [7,]    1    1 #>  [8,]    1    1 #>  [9,]    1    1 #> [10,]    1    1 #>  to012(Z) #>       [,1] [,2] #>  [1,]    0    2 #>  [2,]    0    2 #>  [3,]    2    2 #>  [4,]    2    2 #>  [5,]    2    2 #>  [6,]    2    2 #>  [7,]    2    2 #>  [8,]    1    2 #>  [9,]    0    2 #> [10,]    2    2"},{"path":"/news/index.html","id":"wgslr-002","dir":"Changelog","previous_headings":"","what":"wgsLR 0.0.2","title":"wgsLR 0.0.2","text":"Added NEWS.md file track changes package. xT trace sample (instead xD) xR reference sample (instead xS) wT Trace sample wR Reference sample Convention: postfix _w error rate samples postfix _wTwR allow different error rates donor (trace) suspect (reference) sample. calc_LRs_wTwR() renamed calc_LRs_w() sample_data_Hp_wTwR(), sample_data_Hd_wTwR() add_errors_Hp_wTwR(), add_errors_Hd_wTwR() d_formulas_Hd_wTwR, d_formulas_Hp_wTwR, d_prob_Hp_wTwR, d_prob_Hd_wTwR, d_LR_wTwR calc_LRs() renamed calc_LRs_w() sample_data_Hp() renamed sample_data_Hp_w() sample_data_Hd() renamed sample_data_Hd_w() add_errors_Hp() renamed add_errors_Hp_w() add_errors_Hd() renamed add_errors_Hd_w() d_formulas_Hd renamed d_formulas_Hd_w d_formulas_Hp renamed d_formulas_Hp_w d_prob_Hp renamed d_prob_Hp_w d_prob_Hd renamed d_prob_Hd_w d_prob_LR renamed d_LR_w","code":""}]
